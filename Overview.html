<!DOCTYPE html><html lang="en-US"><meta charset="utf-8">
<title>Encoding Standard</title>
<style>
 pre.idl { border:solid thin; background:#eee; color:#000; padding:0.5em }
 pre.idl :link, pre.idl :visited { color:inherit; background:transparent }
 pre code { color:inherit; background:transparent }
 .example { margin-left:1em; padding-left:1em; border-left:double; color:#222; background:#fcfcfc }
 .note { margin-left:2em; font-weight:bold; font-style:italic; color:#008000 }
 p.note::before { content:"Note: " }
 .XXX { padding:.5em; border:solid #f00 }
 /*p.XXX::before { content:"Issue: " }*/
 dl.switch { padding-left:2em }
 dl.switch > dt { text-indent:-1.5em }
 dl.switch > dt:before { content:'\21AA'; padding:0 0.5em 0 0; display:inline-block; width:1em; text-align:right; line-height:0.5em }
 dl.domintro { color: green; margin: 2em 0 2em 2em; padding: 0.5em 1em; border: none; background: #DDFFDD; }
 dl.domintro dt, dl.domintro dt * { color: black; text-decoration: none; }
 dl.domintro dd { margin: 0.5em 0 1em 2em; padding: 0; }
 dl.domintro dd p { margin: 0.5em 0; }
 dl.domintro:before { display: table; margin: -1em -0.5em -0.5em auto; width: auto; content: 'This box is non-normative. Implementation requirements are given below this box.'; color: red; border: solid 2px; background: white; padding: 0 0.25em; }
 em.ct { text-transform:lowercase; font-variant:small-caps; font-style:normal }
 dfn { font-weight:bold; font-style:normal }
 code { color:orangered }
 code :link, code :visited { color:inherit }
 hr:not(.top) { display:block; background:none; border:none; padding:0; margin:2em 0; height:auto }
 table { border-collapse:collapse; border-style:hidden hidden none hidden }
 table thead { border-bottom:solid }
 table tbody th:first-child { border-left:solid }
 table td, table th { border-left:solid; border-right:solid; border-bottom:solid thin; vertical-align:top; padding:0.2em }
 .encoding th, .encoding td { font-family:monospace }

 .warning { color: red; background: transparent; font-weight: bolder; font-style: italic; }
 .warning p:first-child { margin-top: 0; }
 .warning p:last-child { margin-bottom: 0; }
 .warning:before { font-style: normal; }
 p.warning:before { content: '\26A0 Warning! '; }
</style>
<style>
 @media print { [data-anolis-spec]::after { content:"[" attr(data-anolis-spec) "]"; font-size:.6em; vertical-align:super; text-transform:uppercase } }
</style>
<link href="http://www.whatwg.org/style/specification" rel="stylesheet">

<div class="head">

<h1>Encoding</h1>
<h2 class="no-num no-toc" id="living-draft-—-6-april-2012">Living Draft — 6 April 2012</h2>

<dl>
 <dt>This Version:
 <dd><a href="http://dvcs.w3.org/hg/encoding/raw-file/tip/Overview.html">http://dvcs.w3.org/hg/encoding/raw-file/tip/Overview.html</a>

 <dt>Participate:</dt>
 <dd>Send feedback to <a href="http://www.whatwg.org/mailing-list">whatwg@whatwg.org</a>
 (<a href="http://www.whatwg.org/mailing-list#specs">archives</a>) or
 <a href="https://www.w3.org/Bugs/Public/enter_bug.cgi?product=Web%20Platform%20%28other%29&amp;component=Encoding">file a bug</a>
 (<a href="https://www.w3.org/Bugs/Public/buglist.cgi?product=Web%20Platform%20%28other%29&amp;component=Encoding&amp;resolution=---">open bugs</a>)
 <dd><a href="http://wiki.whatwg.org/wiki/IRC">IRC: #whatwg on Freenode</a>

 <dt>Editor:
 <dd class="vcard h-card">
  <a class="url u-url fn p-fn" href="http://annevankesteren.nl/" lang="nl">Anne van Kesteren</a>
  (<a class="org h-org" href="http://www.opera.com/">Opera Software ASA</a>)
  &lt;<a class="email u-email" href="mailto:annevk@opera.com">annevk@opera.com</a>&gt;
</dl>

<p class="copyright"><a href="http://creativecommons.org/publicdomain/zero/1.0/" rel="license"><img alt="CC0" src="http://i.creativecommons.org/p/zero/1.0/80x15.png"></a>
To the extent possible under law, the editors have waived all copyright and
related or neighboring rights to this work. In addition, as of
6 April 2012, the editors have made this specification available
under the
<a href="http://www.openwebfoundation.org/legal/the-owf-1-0-agreements/owfa-1-0" rel="license">Open Web Foundation Agreement Version 1.0</a>,
which is available at
http://www.openwebfoundation.org/legal/the-owf-1-0-agreements/owfa-1-0.

</div>


<h2 class="no-num no-toc" id="table-of-contents">Table of Contents</h2>


<!--begin-toc-->
<ol class="toc">
 <li><a href="#preface"><span class="secno">1 </span>Preface</a></li>
 <li><a href="#conformance"><span class="secno">2 </span>Conformance</a></li>
 <li><a href="#terminology"><span class="secno">3 </span>Terminology</a></li>
 <li><a href="#encodings"><span class="secno">4 </span>Encodings</a></li>
 <li><a href="#decode-and-encode"><span class="secno">5 </span>Decode and encode</a></li>
 <li><a href="#the-encoding"><span class="secno">6 </span>The encoding</a>
  <ol>
   <li><a href="#utf-8"><span class="secno">6.1 </span>utf-8</a></ol></li>
 <li><a href="#legacy-single-byte-encodings"><span class="secno">7 </span>Legacy single-byte encodings</a></li>
 <li><a href="#legacy-multi-byte-chinese-(simplified)-encodings"><span class="secno">8 </span>Legacy multi-byte Chinese (simplified) encodings</a>
  <ol>
   <li><a href="#gbk"><span class="secno">8.1 </span>gbk</a></li>
   <li><a href="#gb18030"><span class="secno">8.2 </span>gb18030</a></li>
   <li><a href="#hz-gb-2312"><span class="secno">8.3 </span>hz-gb-2312</a></li>
   <li><a href="#iso-2022-cn"><span class="secno">8.4 </span>iso-2022-cn</a></ol></li>
 <li><a href="#legacy-multi-byte-chinese-(traditional)-encodings"><span class="secno">9 </span>Legacy multi-byte Chinese (traditional) encodings</a>
  <ol>
   <li><a href="#big5"><span class="secno">9.1 </span>big5</a></ol></li>
 <li><a href="#legacy-multi-byte-japanese-encodings"><span class="secno">10 </span>Legacy multi-byte Japanese encodings</a>
  <ol>
   <li><a href="#euc-jp"><span class="secno">10.1 </span>euc-jp</a></li>
   <li><a href="#iso-2022-jp"><span class="secno">10.2 </span>iso-2022-jp</a></li>
   <li><a href="#shift_jis"><span class="secno">10.3 </span>shift_jis</a></ol></li>
 <li><a href="#legacy-multi-byte-korean-encodings"><span class="secno">11 </span>Legacy multi-byte Korean encodings</a>
  <ol>
   <li><a href="#euc-kr"><span class="secno">11.1 </span>euc-kr</a></li>
   <li><a href="#iso-2022-kr"><span class="secno">11.2 </span>iso-2022-kr</a></ol></li>
 <li><a href="#legacy-utf-16-encodings"><span class="secno">12 </span>Legacy utf-16 encodings</a>
  <ol>
   <li><a href="#utf-16"><span class="secno">12.1 </span>utf-16</a></li>
   <li><a href="#utf-16be"><span class="secno">12.2 </span>utf-16be</a></ol></li>
 <li><a class="no-num" href="#references">References</a></li>
 <li><a class="no-num" href="#acknowledgments">Acknowledgments</a></ol>
<!--end-toc-->


<h2 id="preface"><span class="secno">1 </span>Preface</h2>

<p>While encodings for the web platform have been defined to some extent,
implementations have not always implemented them in the same way, have not
always used the same labels, and often differ in dealing with undefined
areas of encodings. This standard attempts to fill those gaps so that new
implementations do not have to reverse engineer encoding implementations of
the market leaders.</p>


<h2 id="conformance"><span class="secno">2 </span>Conformance</h2>

<p>All diagrams, examples, and notes in this specification are
non-normative, as are all sections explicitly marked non-normative.
Everything else in this specification is normative.

<p>The key words "MUST", "MUST NOT", "REQUIRED", <!--"SHALL", "SHALL
NOT",--> "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and
"OPTIONAL" in the normative parts of this document are to be
interpreted as described in RFC2119. For readability, these words do
not appear in all uppercase letters in this specification.
<a data-anolis-ref="" href="#refsRFC2119">[RFC2119]</a>

<p>Conformance requirements phrased as algorithms or specific steps
may be implemented in any manner, so long as the end result is
equivalent. (In particular, the algorithms defined in this
specification are intended to be easy to follow, and not intended to
be performant.)

<p id="hardwareLimitations">User agents may impose
implementation-specific limits on otherwise unconstrained inputs,
e.g. to prevent denial of service attacks, to guard against running
out of memory, or to work around platform-specific limitations.


<h2 id="terminology"><span class="secno">3 </span>Terminology</h2>

<p>A <dfn id="code-point">code point</dfn> is a Unicode code point and is referenced as a
four-or-more digit hexadecimal value, typically preceded by "U+". E.g. U+0020.

<p>The <dfn id="fallback-code-point">fallback code point</dfn> is U+FFFD.

<p>A <dfn id="byte">byte</dfn> is referenced as a double-digit hexadecimal value,
typically preceded by "0x". E.g. 0xAA. A byte never consists of more, nor
less than exactly eight bits (at least as far as the web platform is
concerned).

<p>The <dfn id="space-characters">space characters</dfn>, for the purposes of this specification,
are U+0020 SPACE, U+0009 CHARACTER TABULATION (tab), U+000A LINE FEED (LF),
U+000C FORM FEED (FF), and U+000D CARRIAGE RETURN (CR).

<p>Comparing two strings in an <dfn id="ascii-case-insensitive">ASCII case-insensitive</dfn> manner
means comparing them exactly, code point for code point, except that the
characters in the range U+0041 to U+005A (i.e. LATIN CAPITAL LETTER A to
LATIN CAPITAL LETTER Z) and the corresponding characters in the range
U+0061 to U+007A (i.e. LATIN SMALL LETTER A to LATIN SMALL LETTER Z) are
considered to also match.


<h2 id="encodings"><span class="secno">4 </span>Encodings</h2>

<p>An <dfn id="concept-encoding" title="concept-encoding">encoding</dfn> defines a mapping from a
code point to one or more bytes (and vice versa). Each
<a href="#concept-encoding" title="concept-encoding">encoding</a> has a
<dfn id="concept-encoding-name" title="concept-encoding-name">name</dfn>, and one or more
<dfn id="concept-encoding-label" title="concept-encoding-label">labels</dfn>.

<p>Each <a href="#concept-encoding" title="concept-encoding">encoding</a> also has a
<dfn id="decoder">decoder</dfn> and <dfn id="encoder">encoder</dfn> algorithm.

<p>A <a href="#decoder">decoder</a> algorithm takes a stream of bytes and emits a
stream of code points. The <dfn id="byte-pointer">byte pointer</dfn> is initially zero,
pointing to the first byte in the stream. It cannot be negative. It can be
increased and decreased to point to other bytes in the stream. The
<dfn id="eof-byte">EOF byte</dfn> is a conceptual byte representing the last byte in a
stream. The <a href="#byte-pointer">byte pointer</a> cannot point beyond the
<a href="#eof-byte">EOF byte</a>. The <dfn id="eof-code-point">EOF code point</dfn> is a conceptual code
point that is emitted once the stream of bytes is handled in its entirety.
A <a href="#decoder">decoder</a> can end by emitting a code point, or the word
continue. Unless the <a href="#eof-code-point">EOF code point</a> is emitted, the
<a href="#decoder">decoder</a> algorithm must be invoked again.

<p>A <a href="#decoder">decoder</a> contains one or more <dfn id="decoder-error">decoder error</dfn>
points. Unless stated otherwise a <a href="#fallback-code-point">fallback code point</a> must be
emitted at that point.

<p class="note">An XML processor would halt upon encountering the first
<a href="#decoder-error">decoder error</a>.

<p>An <a href="#encoder">encoder</a> algorithm takes a
stream of code points and emits a stream of bytes. It will fail when
a code point is passed for which it does not have a corresponding byte or
byte sequence. Analogously to a <a href="#decoder">decoder</a>, it has a
<dfn id="code-point-pointer">code point pointer</dfn>. Again analogously, as long as the
<a href="#eof-byte">EOF byte</a> is not emitted, the <a href="#encoder">encoder</a> algorithm
must be invoked for each byte or sequence of bytes emitted.

<p>An <a href="#encoder">encoder</a> contains one or more <dfn id="encoder-error">encoder error</dfn>
points. Unless stated otherwise the <a href="#encoder">encoder</a> is terminated at
that point.

<p class="note">HTML forms and URLs require non-terminating
<a href="#encoder" title="encoder">encoders</a> and have therefore special handling
whenever an <a href="#encoder-error">encoder error</a> is reached.

<hr>

<p>The table below lists all <a href="#concept-encoding" title="concept-encoding">encodings</a>
and their <a href="#concept-encoding-label" title="concept-encoding-label">labels</a> user agents must
support. User agents must not support any other
<a href="#concept-encoding" title="concept-encoding">encodings</a> or
<a href="#concept-encoding-label" title="concept-encoding-label">labels</a>.

<p>To <dfn id="concept-encoding-get" title="concept-encoding-get">get an encoding</dfn> from a string
<var title="">label</var>, run these steps:

<ol>
 <li><p>Remove any leading and trailing <a href="#space-characters">space characters</a> from
 <var title="">label</var>.

 <li><p>If <var title="">label</var> is an <a href="#ascii-case-insensitive">ASCII case-insensitive</a>
 match for any of the <a href="#concept-encoding-label" title="concept-encoding-label">labels</a>
 listed in the table below, return the corresponding
 <a href="#concept-encoding" title="concept-encoding">encoding</a> and terminate these steps.

 <li><p>Return failure.
</ol>

<p class="note">This algorithm is different from the one defined
in
<a href="http://www.unicode.org/reports/tr22/tr22-7.html#Charset_Alias_Matching">section 1.4 of Unicode Technical Standard #22</a>
as that algorithm is incompatible with legacy content.

<table>
 <thead>
  <tr>
   <th><a href="#concept-encoding-name" title="concept-encoding-name">Name</a>
   <th><a href="#concept-encoding-label" title="concept-encoding-label">Labels</a>
 <tbody>
  <tr><th colspan="2"><a href="#the-encoding">The Encoding</a>
  <tr>
   <td rowspan="3"><a href="#utf-8">utf-8</a>
   <td>"<code title="">unicode-1-1-utf-8</code>"
  <tr><td>"<code title="">utf-8</code>"
  <tr><td>"<code title="">utf8</code>"
 <tbody>
  <tr><th colspan="2"><a href="#legacy-single-byte-encodings">Legacy single-byte encodings</a>
  <tr>
   <td rowspan="2"><a href="#ibm864">ibm864</a>
   <td>"<code title="">cp864</code>"
  <tr><td>"<code title="">ibm864</code>"
  <tr>
   <td rowspan="2"><a href="#ibm866">ibm866</a>
   <td>"<code title="">cp866</code>"
  <tr><td>"<code title="">ibm866</code>"
  <tr>
   <td rowspan="7"><a href="#iso-8859-2">iso-8859-2</a>
   <td>"<code title="">csisolatin2</code>"
  <tr><td>"<code title="">iso-8859-2</code>"
  <tr><td>"<code title="">iso-ir-101</code>"
  <tr><td>"<code title="">iso8859-2</code>"
  <tr><td>"<code title="">iso_8859-2</code>"
  <tr><td>"<code title="">l2</code>"
  <tr><td>"<code title="">latin2</code>"
  <tr>
   <td rowspan="6"><a href="#iso-8859-3">iso-8859-3</a>
   <td>"<code title="">csisolatin3</code>"
  <tr><td>"<code title="">iso-8859-3</code>"
  <tr><td>"<code title="">iso-ir-109</code>"
  <tr><td>"<code title="">iso_8859-3</code>"
  <tr><td>"<code title="">l3</code>"
  <tr><td>"<code title="">latin3</code>"
  <tr>
   <td rowspan="6"><a href="#iso-8859-4">iso-8859-4</a>
   <td>"<code title="">csisolatin4</code>"
  <tr><td>"<code title="">iso-8859-4</code>"
  <tr><td>"<code title="">iso-ir-110</code>"
  <tr><td>"<code title="">iso_8859-4</code>"
  <tr><td>"<code title="">l4</code>"
  <tr><td>"<code title="">latin4</code>"
  <tr>
   <td rowspan="5"><a href="#iso-8859-5">iso-8859-5</a>
   <td>"<code title="">csisolatincyrillic</code>"
  <tr><td>"<code title="">cyrillic</code>"
  <tr><td>"<code title="">iso-8859-5</code>"
  <tr><td>"<code title="">iso-ir-144</code>"
  <tr><td>"<code title="">iso_8859-5</code>"
  <tr>
   <td rowspan="6"><a href="#iso-8859-6">iso-8859-6</a>
   <td>"<code title="">arabic</code>"
  <tr><td>"<code title="">csisolatinarabic</code>"
  <tr><td>"<code title="">ecma-114</code>"
  <tr><td>"<code title="">iso-8859-6</code>"
  <tr><td>"<code title="">iso-ir-127</code>"
  <tr><td>"<code title="">iso_8859-6</code>"
  <tr>
   <td rowspan="8"><a href="#iso-8859-7">iso-8859-7</a>
   <td>"<code title="">csisolatingreek</code>"
  <tr><td>"<code title="">ecma-118</code>"
  <tr><td>"<code title="">elot_928</code>"
  <tr><td>"<code title="">greek</code>"
  <tr><td>"<code title="">greek8</code>"
  <tr><td>"<code title="">iso-8859-7</code>"
  <tr><td>"<code title="">iso-ir-126</code>"
  <tr><td>"<code title="">iso_8859-7</code>"
  <tr>
   <td rowspan="7"><a href="#iso-8859-8">iso-8859-8</a>
   <td>"<code title="">csisolatinhebrew</code>"
  <tr><td>"<code title="">hebrew</code>"
  <tr><td>"<code title="">iso-8859-8</code>"
  <tr><td>"<code title="">iso-8859-8-i</code>"
  <tr><td>"<code title="">iso-ir-138</code>"
  <tr><td>"<code title="">iso_8859-8</code>"
  <tr><td>"<code title="">visual</code>"
  <tr>
   <td rowspan="6"><a href="#iso-8859-10">iso-8859-10</a>
   <td>"<code title="">csisolatin6</code>"
  <tr><td>"<code title="">iso-8859-10</code>"
  <tr><td>"<code title="">iso-ir-157</code>"
  <tr><td>"<code title="">iso8859-10</code>"
  <tr><td>"<code title="">l6</code>"
  <tr><td>"<code title="">latin6</code>"
  <tr>
   <td><a href="#iso-8859-13">iso-8859-13</a>
   <td>"<code title="">iso-8859-13</code>"
  <tr>
   <td rowspan="2"><a href="#iso-8859-14">iso-8859-14</a>
   <td>"<code title="">iso-8859-14</code>"
  <tr><td>"<code title="">iso8859-14</code>"
  <tr>
   <td rowspan="2"><a href="#iso-8859-15">iso-8859-15</a>
   <td>"<code title="">iso-8859-15</code>"
  <tr><td>"<code title="">iso_8859-15</code>"
  <tr>
   <td><a href="#iso-8859-16">iso-8859-16</a>
   <td>"<code title="">iso-8859-16</code>"
  <tr>
   <td rowspan="2"><a href="#koi8-r">koi8-r</a>
   <td>"<code title="">koi8-r</code>"
  <tr><td>"<code title="">koi8_r</code>"
  <tr>
   <td><a href="#koi8-u">koi8-u</a>
   <td>"<code title="">koi8-u</code>"
  <tr>
   <td rowspan="4"><a href="#macintosh">macintosh</a>
   <td>"<code title="">csmacintosh</code>"
  <tr><td>"<code title="">mac</code>"
  <tr><td>"<code title="">macintosh</code>"
  <tr><td>"<code title="">x-mac-roman</code>"
  <tr>
   <td rowspan="3"><a href="#windows-874">windows-874</a>
   <td>"<code title="">iso-8859-11</code>"
  <tr><td>"<code title="">tis-620</code>"
  <tr><td>"<code title="">windows-874</code>"
  <tr>
   <td rowspan="2"><a href="#windows-1250">windows-1250</a>
   <td>"<code title="">windows-1250</code>"
  <tr><td>"<code title="">x-cp1250</code>"
  <tr>
   <td rowspan="2"><a href="#windows-1251">windows-1251</a>
   <td>"<code title="">windows-1251</code>"
  <tr><td>"<code title="">x-cp1251</code>"
  <tr>
   <td rowspan="10"><a href="#windows-1252">windows-1252</a>
   <td>"<code title="">ansi_x3.4-1968</code>"
  <tr><td>"<code title="">ascii</code>"
  <tr><td>"<code title="">csisolatin1</code>"
  <tr><td>"<code title="">iso-8859-1</code>"
  <tr><td>"<code title="">iso8859-1</code>"
  <tr><td>"<code title="">iso_8859-1</code>"
  <tr><td>"<code title="">l1</code>"
  <tr><td>"<code title="">latin1</code>"
  <tr><td>"<code title="">us-ascii</code>"
  <tr><td>"<code title="">windows-1252</code>"
  <tr>
   <td rowspan="2"><a href="#windows-1253">windows-1253</a>
   <td>"<code title="">cp1253</code>"
  <tr><td>"<code title="">windows-1253</code>"
  <tr>
   <td rowspan="6"><a href="#windows-1254">windows-1254</a>
   <td>"<code title="">csisolatin5</code>"
  <tr><td>"<code title="">iso-8859-9</code>"
  <tr><td>"<code title="">iso-ir-148</code>"
  <tr><td>"<code title="">l5</code>"
  <tr><td>"<code title="">latin5</code>"
  <tr><td>"<code title="">windows-1254</code>"
  <tr>
   <td rowspan="2"><a href="#windows-1255">windows-1255</a>
   <td>"<code title="">cp1255</code>"
  <tr><td>"<code title="">windows-1255</code>"
  <tr>
   <td rowspan="2"><a href="#windows-1256">windows-1256</a>
   <td>"<code title="">cp1256</code>"
  <tr><td>"<code title="">windows-1256</code>"
  <tr>
   <td><a href="#windows-1257">windows-1257</a>
   <td>"<code title="">windows-1257</code>"
  <tr>
   <td rowspan="2"><a href="#windows-1258">windows-1258</a>
   <td>"<code title="">cp1258</code>"
  <tr><td>"<code title="">windows-1258</code>"
  <tr>
   <td rowspan="2"><a href="#x-mac-cyrillic">x-mac-cyrillic</a>
   <td>"<code title="">x-mac-cyrillic</code>"
  <tr><td>"<code title="">x-mac-ukrainian</code>"
 <tbody>
  <tr><th colspan="2"><a href="#legacy-multi-byte-chinese-(simplified)-encodings">Legacy multi-byte Chinese (simplified) encodings</a>
  <tr>
   <td rowspan="9"><a href="#gbk">gbk</a>
   <td>"<code title="">chinese</code>"
  <tr><td>"<code title="">csgb2312</code>"
  <tr><td>"<code title="">csiso58gb231280</code>"
  <tr><td>"<code title="">gb2312</code>"
  <tr><td>"<code title="">gb_2312</code>"
  <tr><td>"<code title="">gb_2312-80</code>"
  <tr><td>"<code title="">gbk</code>"
  <tr><td>"<code title="">iso-ir-58</code>"
  <tr><td>"<code title="">x-gbk</code>"
  <tr>
   <td><a href="#gb18030">gb18030</a>
   <td>"<code title="">gb18030</code>"
  <tr>
   <td><a href="#hz-gb-2312">hz-gb-2312</a>
   <td>"<code title="">hz-gb-2312</code>"
  <tr>
   <td rowspan="2"><a href="#iso-2022-cn">iso-2022-cn</a>
   <td>"<code title="">iso-2022-cn</code>"
  <tr><td>"<code title="">iso-2022-cn-ext</code>"
 <tbody>
  <tr><th colspan="2"><a href="#legacy-multi-byte-chinese-(traditional)-encodings">Legacy multi-byte Chinese (traditional) encodings</a>
  <tr>
   <td rowspan="5"><a href="#big5">big5</a>
   <td>"<code title="">big5</code>"
  <tr><td>"<code title="">big5-hkscs</code>"
  <tr><td>"<code title="">cn-big5</code>"
  <tr><td>"<code title="">csbig5</code>"
  <tr><td>"<code title="">x-x-big5</code>"
 <tbody>
  <tr><th colspan="2"><a href="#legacy-multi-byte-japanese-encodings">Legacy multi-byte Japanese encodings</a>
  <tr>
   <td rowspan="3"><a href="#euc-jp">euc-jp</a>
   <td>"<code title="">cseucjpkdfmtjapanese</code>"
  <tr><td>"<code title="">euc-jp</code>"
  <tr><td>"<code title="">x-euc-jp</code>"
  <tr>
   <td rowspan="2"><a href="#iso-2022-jp">iso-2022-jp</a>
   <td>"<code title="">csiso2022jp</code>"
  <tr><td>"<code title="">iso-2022-jp</code>"
  <tr>
   <td rowspan="6"><a href="#shift_jis">shift_jis</a>
   <td>"<code title="">csshiftjis</code>"
  <tr><td>"<code title="">ms_kanji</code>"
  <tr><td>"<code title="">shift-jis</code>"
  <tr><td>"<code title="">shift_jis</code>"
  <tr><td>"<code title="">windows-31j</code>"
  <tr><td>"<code title="">x-sjis</code>"
 <tbody>
  <tr><th colspan="2"><a href="#legacy-multi-byte-korean-encodings">Legacy multi-byte Korean encodings</a>
  <tr>
   <td rowspan="9"><a href="#euc-kr">euc-kr</a>
   <td>"<code title="">csksc56011987</code>"
  <tr><td>"<code title="">csueckr</code>"
  <tr><td>"<code title="">euc-kr</code>"
  <tr><td>"<code title="">iso-ir-149</code>"
  <tr><td>"<code title="">korean</code>"
  <tr><td>"<code title="">ks_c_5601-1989</code>"
  <tr><td>"<code title="">ksc5601</code>"
  <tr><td>"<code title="">ksc_5601</code>"
  <tr><td>"<code title="">windows-949</code>"
  <tr>
   <td rowspan="2"><a href="#iso-2022-kr">iso-2022-kr</a>
   <td>"<code title="">csiso2022kr</code>"
  <tr><td>"<code title="">iso-2022-kr</code>"
 <tbody>
  <tr><th colspan="2"><a href="#legacy-utf-16-encodings">Legacy utf-16 encodings</a>
  <tr>
   <td rowspan="2"><a href="#utf-16">utf-16</a>
   <td>"<code title="">utf-16</code>"
  <tr><td>"<code title="">utf-16le</code>"
  <tr>
   <td><a href="#utf-16be">utf-16be</a>
   <td>"<code title="">utf-16be</code>"
</table>


<h2 id="decode-and-encode"><span class="secno">5 </span>Decode and encode</h2>

<p class="note">The algorithms <a href="#decode">decode</a>, <a href="#utf-8-decode">utf-8 decode</a>,
and <a href="#encode">encode</a> are intended for usage by other specifications.
<a href="#utf-8-decode">utf-8 decode</a> is to be used by new formats. The
<a href="#concept-encoding-get" title="concept-encoding-get">get an encoding</a> algorithm can be
used first to turn a <a href="#concept-encoding-label" title="concept-encoding-label">label</a> into an
<a href="#concept-encoding" title="concept-encoding">encoding</a>.

<p>To <dfn id="decode">decode</dfn> a byte stream <var title="">stream</var> using
fallback encoding <var title="">encoding</var>, run these steps:

<ol>
 <li><p>Let <var title="">offset</var> be 0.

 <li>
  <p>For each of the rows in the following table, starting with the first
  one and going down, if the first bytes of <var title="">stream</var> match
  all the bytes given in the first column (ergo <var title="">stream</var>
  contains at least two or three bytes), then set <var title="">encoding</var>
  to the <a href="#concept-encoding" title="concept-encoding">encoding</a> given in the cell in
  the second column of that row, and set <var title="">offset</var> to the
  offset given in the cell in the third column of that row.

  <table>
   <tr><th>Byte order mark<th>Encoding<th>Offset
   <tr><td>0xFF 0xFE<td><a href="#utf-16">utf-16</a><td>2
   <tr><td>0xFE 0xFF<td><a href="#utf-16be">utf-16be</a><td>2
   <tr><td>0xEF 0xBB 0xBF<td><a href="#utf-8">utf-8</a><td>3
  </table>

  <p class="note">For compatibility with deployed content, the byte order mark
  is considered more authoritative than anything else.

 <li><p>Return the result of running <var title="">encoding</var>'s
 <a href="#decoder">decoder</a> with <a href="#byte-pointer">byte pointer</a> set to
 <var title="">offset</var>, on <var title="">stream</var>.
</ol>

<p>To <dfn id="utf-8-decode">utf-8 decode</dfn> a byte stream <var title="">stream</var>, run
these steps:

<ol>
 <li><p>Let <var title="">offset</var> be 0.

 <li><p>If <var title="">stream</var> contains at least three bytes and its
 first three bytes match 0xEF 0xBB 0xBF, set <var title="">offset</var> to 3.

 <li><p>Return the result of running the <a href="#utf-8-decoder">utf-8 decoder</a> with
 <a href="#byte-pointer">byte pointer</a> set to <var title="">offset</var>, on
 <var title="">stream</var>.
</ol>

<p>To <dfn id="encode">encode</dfn> a code point stream <var title="">stream</var> using
encoding <var title="">encoding</var>, return the result of running
<var title="">encoding</var>'s <a href="#encoder">encoder</a> on <var title="">stream</var>.


<h2 id="the-encoding"><span class="secno">6 </span>The encoding</h2>

<p>New content and formats must exclusively use the <a href="#utf-8">utf-8</a>
<a href="#concept-encoding" title="concept-encoding">encoding</a>.


<h3 id="utf-8"><span class="secno">6.1 </span><dfn>utf-8</dfn></h3>

<!--
http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#utf-8
Unicode
-->

<p>The <dfn id="utf-8-code-point">utf-8 code point</dfn>, <dfn id="utf-8-bytes-seen">utf-8 bytes seen</dfn>,
<dfn id="utf-8-bytes-needed">utf-8 bytes needed</dfn>, and <dfn id="utf-8-lower-boundary">utf-8 lower boundary</dfn> concepts
are all initially 0.

<p>The <dfn id="utf-8-decoder">utf-8 decoder</dfn> (<a href="#decoder">decoder</a> for <a href="#utf-8">utf-8</a>) is:

<ol>
 <li><p>Let <var title="">byte</var> be <a href="#byte-pointer">byte pointer</a>.

 <li><p>If <var title="">byte</var> is the <a href="#eof-byte">EOF byte</a> and
 <a href="#utf-8-bytes-needed">utf-8 bytes needed</a> is not 0, set
 <a href="#utf-8-bytes-needed">utf-8 bytes needed</a> to 0; this is a <a href="#decoder-error">decoder error</a>.

 <li><p>If <var title="">byte</var> is the <a href="#eof-byte">EOF byte</a>, emit the
 <a href="#eof-code-point">EOF code point</a>.

 <li><p>Increase the <a href="#byte-pointer">byte pointer</a>.

 <li>
  <p>If <a href="#utf-8-bytes-needed">utf-8 bytes needed</a> is 0, based on
  <var title="">byte</var>:

  <dl class="switch">
   <dt>0x00 to 0x7F
   <dd><p>Emit <var title="">byte</var> as code point.

   <dt>0xC0 to 0xDF
   <dd><p>Set <a href="#utf-8-bytes-needed">utf-8 bytes needed</a> to 1,
   <a href="#utf-8-lower-boundary">utf-8 lower boundary</a> to 0x80, and
   <a href="#utf-8-code-point">utf-8 code point</a> to <var title="">byte</var> − 0xC0.

   <dt>0xE0 to 0xEF
   <dd><p>Set <a href="#utf-8-bytes-needed">utf-8 bytes needed</a> to 2,
   <a href="#utf-8-lower-boundary">utf-8 lower boundary</a> to 0x800, and
   <a href="#utf-8-code-point">utf-8 code point</a> to <var title="">byte</var> − 0xE0.

   <dt>0xF0 to 0xF7
   <dd><p>Set <a href="#utf-8-bytes-needed">utf-8 bytes needed</a> to 3,
   <a href="#utf-8-lower-boundary">utf-8 lower boundary</a> to 0x10000, and
   <a href="#utf-8-code-point">utf-8 code point</a> to <var title="">byte</var> − 0xF0.

   <dt>0xF8 to 0xFB
   <dd><p>Set <a href="#utf-8-bytes-needed">utf-8 bytes needed</a> to 4,
   <a href="#utf-8-lower-boundary">utf-8 lower boundary</a> to 0x200000, and
   <a href="#utf-8-code-point">utf-8 code point</a> to <var title="">byte</var> − 0xF8.

   <dt>0xFC to 0xFD
   <dd><p>Set <a href="#utf-8-bytes-needed">utf-8 bytes needed</a> to 5,
   <a href="#utf-8-lower-boundary">utf-8 lower boundary</a> to 0x4000000, and
   <a href="#utf-8-code-point">utf-8 code point</a> to <var title="">byte</var> − 0xFC.

   <dt>Otherwise
   <dd><p>This is a <a href="#decoder-error">decoder error</a>.
  </dl>

  <p>Then (<var title="">byte</var> was in the range 0xC0 to 0xFD) set
  <a href="#utf-8-code-point">utf-8 code point</a> to <a href="#utf-8-code-point">utf-8 code point</a> ×
  64<sup><a href="#utf-8-bytes-needed">utf-8 bytes needed</a></sup> and continue.

 <li>
  <p>If <var title="">byte</var> is not in the range 0x80 to 0xBF, run these
  substeps:

  <ol>
   <li><p>Set <a href="#utf-8-code-point">utf-8 code point</a>,
   <a href="#utf-8-bytes-needed">utf-8 bytes needed</a>, <a href="#utf-8-bytes-seen">utf-8 bytes seen</a>, and
   <a href="#utf-8-lower-boundary">utf-8 lower boundary</a> to 0.

   <li><p>Decrease the <a href="#byte-pointer">byte pointer</a> by one.

   <li><p>This is a <a href="#decoder-error">decoder error</a>.
  </ol>

 <li>
  <p>Increase <a href="#utf-8-bytes-seen">utf-8 bytes seen</a> by one and set
  <a href="#utf-8-code-point">utf-8 code point</a> to
  <a href="#utf-8-code-point">utf-8 code point</a> + (<var title="">byte</var> − 0x80) ×
  64<sup><a href="#utf-8-bytes-needed">utf-8 bytes needed</a> − <a href="#utf-8-bytes-seen">utf-8 bytes seen</a></sup>

 <li><p>If <a href="#utf-8-bytes-seen">utf-8 bytes seen</a> is not equal to
 <a href="#utf-8-bytes-needed">utf-8 bytes needed</a>, continue.

 <li><p>Let <var title="">code point</var> be <a href="#utf-8-code-point">utf-8 code point</a> and
 <var title="">lower boundary</var> be <a href="#utf-8-lower-boundary">utf-8 lower boundary</a>

 <li><p>Set <a href="#utf-8-code-point">utf-8 code point</a>,
 <a href="#utf-8-bytes-needed">utf-8 bytes needed</a>, <a href="#utf-8-bytes-seen">utf-8 bytes seen</a>, and
 <a href="#utf-8-lower-boundary">utf-8 lower boundary</a> to 0.

 <li><p>If <var title="">code point</var> is equal or greater than
 <var title="">lower boundary</var>, equal or smaller than 0x10FFFF, and is not
 in the range 0xD800 to 0xDFFF, emit <var title="">code point</var>.

 <li><p>This is a <a href="#decoder-error">decoder error</a>.
</ol>


<p>The <dfn id="utf-8-encoder">utf-8 encoder</dfn> (<a href="#encoder">encoder</a> for <a href="#utf-8">utf-8</a>) is:

<ol>
 <li><p>Let <var title="">code point</var> be <a href="#code-point-pointer">code point pointer</a>.

 <li><p>If <var title="">code point</var> is in the range 0xD800 to 0xDFFF,
 this is an <a href="#encoder-error">encoder error</a>.

 <li><p>If <var title="">code point</var> is the <a href="#eof-code-point">EOF code point</a>,
 emit the <a href="#eof-byte">EOF byte</a>.

 <li><p>Increase the <a href="#code-point-pointer">code point pointer</a> by one.

 <li><p>If <var title="">code point</var> is in the range U+0000 to U+007F,
 emit a byte whose value is <var title="">code point</var>.

 <li>
  <p>Set <var title="">count</var> and <var title="">offset</var> based on the
  range <var title="">code point</var> is in:

  <dl class="switch">
   <dt>U+0080 to U+07FF
   <dd>1 and 0xC0
   <dt>U+0800 to U+FFFF
   <dd>2 and 0xE0
   <dt>U+10000 to U+10FFFF
   <dd>3 and 0xF0
  </dl>

 <li><p>Let <var title="">bytes</var> be a list of bytes whose first byte is
 <var title="">code point</var> divided by
 64<sup><var title="">count</var></sup> (as integers) + <var title="">offset</var>.

 <li>
  <p>Run these substeps while <var title="">count</var> is greater than 0:

  <ol>
   <li><p>Set <var title="">temp</var> to <var title="">code point</var> divided
   by 64<sup><var title="">count</var> − 1</sup> (as integers).
   <!--temp = code_point >> ((count - 1) * 6)-->

   <li><p>Append to <var title="">bytes</var> 0x80 + the remainder of dividing
   <var title="">temp</var> by 64<sup></sup> (as integers).
   <!--0x80 | (temp & 0x3f)-->

   <li><p>Decrease <var title="">count</var> by one.
  </ol>

 <li><p>Emit a sequence of bytes <var title="">bytes</var>, in list order.
</ol>


<h2 id="legacy-single-byte-encodings"><span class="secno">7 </span>Legacy single-byte encodings</h2>

<p>An <a href="#concept-encoding" title="concept-encoding">encoding</a> where each byte is
either a single code point or nothing, is a
<dfn id="single-byte-encoding">single-byte encoding</dfn>.
<a href="#single-byte-encoding" title="single-byte encoding">Single-byte encodings</a> are
accompanied by a <b title="">map</b> as illustrated in the table below. A
<b title="">map</b> is a newline-separated (U+000A) resource, where each line
starts with a hexadecimal number representing a byte, followed by a U+0009
code point, followed by another hexadecimal number representing a code point,
followed by a U+0009 code point, followed by either the
Unicode Character Name or &lt;Private Use&gt;, preceded by a U+0023 code point.

<table>
 <tr><th><a href="#concept-encoding-name" title="concept-encoding-name">Name</a><th><b title="">Map</b>
 <tr><td><dfn id="ibm864">ibm864</dfn><td><a href="map-ibm864.txt">map-ibm864.txt</a>
 <tr><td><dfn id="ibm866">ibm866</dfn><td><a href="map-ibm866.txt">map-ibm866.txt</a>
 <tr><td><dfn id="iso-8859-2">iso-8859-2</dfn><td><a href="map-iso-8859-2.txt">map-iso-8859-2.txt</a>
 <tr><td><dfn id="iso-8859-3">iso-8859-3</dfn><td><a href="map-iso-8859-3.txt">map-iso-8859-3.txt</a>
 <tr><td><dfn id="iso-8859-4">iso-8859-4</dfn><td><a href="map-iso-8859-4.txt">map-iso-8859-4.txt</a>
 <tr><td><dfn id="iso-8859-5">iso-8859-5</dfn><td><a href="map-iso-8859-5.txt">map-iso-8859-5.txt</a>
 <tr><td><dfn id="iso-8859-6">iso-8859-6</dfn><td><a href="map-iso-8859-6.txt">map-iso-8859-6.txt</a>
 <tr><td><dfn id="iso-8859-7">iso-8859-7</dfn><td><a href="map-iso-8859-7.txt">map-iso-8859-7.txt</a>
 <tr><td><dfn id="iso-8859-8">iso-8859-8</dfn><td><a href="map-iso-8859-8.txt">map-iso-8859-8.txt</a>
 <tr><td><dfn id="iso-8859-10">iso-8859-10</dfn><td><a href="map-iso-8859-10.txt">map-iso-8859-10.txt</a>
 <tr><td><dfn id="iso-8859-13">iso-8859-13</dfn><td><a href="map-iso-8859-13.txt">map-iso-8859-13.txt</a>
 <tr><td><dfn id="iso-8859-14">iso-8859-14</dfn><td><a href="map-iso-8859-14.txt">map-iso-8859-14.txt</a>
 <tr><td><dfn id="iso-8859-15">iso-8859-15</dfn><td><a href="map-iso-8859-15.txt">map-iso-8859-15.txt</a>
 <tr><td><dfn id="iso-8859-16">iso-8859-16</dfn><td><a href="map-iso-8859-16.txt">map-iso-8859-16.txt</a>
 <tr><td><dfn id="koi8-r">koi8-r</dfn><td><a href="map-koi8-r.txt">map-koi8-r.txt</a>
 <tr><td><dfn id="koi8-u">koi8-u</dfn><td><a href="map-koi8-u.txt">map-koi8-u.txt</a>
 <tr><td><dfn id="macintosh">macintosh</dfn><td><a href="map-macintosh.txt">map-macintosh.txt</a>
 <tr><td><dfn id="windows-874">windows-874</dfn><td><a href="map-windows-874.txt">map-windows-874.txt</a>
 <tr><td><dfn id="windows-1250">windows-1250</dfn><td><a href="map-windows-1250.txt">map-windows-1250.txt</a>
 <tr><td><dfn id="windows-1251">windows-1251</dfn><td><a href="map-windows-1251.txt">map-windows-1251.txt</a>
 <tr><td><dfn id="windows-1252">windows-1252</dfn><td><a href="map-windows-1252.txt">map-windows-1252.txt</a>
 <tr><td><dfn id="windows-1253">windows-1253</dfn><td><a href="map-windows-1253.txt">map-windows-1253.txt</a>
 <tr><td><dfn id="windows-1254">windows-1254</dfn><td><a href="map-windows-1254.txt">map-windows-1254.txt</a>
 <tr><td><dfn id="windows-1255">windows-1255</dfn><td><a href="map-windows-1255.txt">map-windows-1255.txt</a>
 <tr><td><dfn id="windows-1256">windows-1256</dfn><td><a href="map-windows-1256.txt">map-windows-1256.txt</a>
 <tr><td><dfn id="windows-1257">windows-1257</dfn><td><a href="map-windows-1257.txt">map-windows-1257.txt</a>
 <tr><td><dfn id="windows-1258">windows-1258</dfn><td><a href="map-windows-1258.txt">map-windows-1258.txt</a>
 <tr><td><dfn id="x-mac-cyrillic">x-mac-cyrillic</dfn><td><a href="map-x-mac-cyrillic.txt">map-x-mac-cyrillic.txt</a>
</table>

<hr>

<p>The <dfn id="single-byte-decoder">single-byte decoder</dfn> (<a href="#decoder">decoder</a> for
<a href="#single-byte-encoding" title="single-byte encoding">single-byte encodings</a>) is:

<ol>
 <li><p>Let <var title="">byte</var> be <a href="#byte-pointer">byte pointer</a>.

 <li><p>If <var title="">byte</var> is the <a href="#eof-byte">EOF byte</a>, emit the
 <a href="#eof-code-point">EOF code point</a>.

 <li><p>Increase the <a href="#byte-pointer">byte pointer</a> by one.

 <li><p>If <var title="">byte</var> is in the range 0x00 to 0x7F, emit a code
 point whose value is <var title="">byte</var>.

 <li><p>If <var title="">byte</var> is not in the <b title="">map</b>, this is a
 <a href="#decoder-error">decoder error</a>.

 <li><p>Emit the code point given in the <b title="">map</b> for
 <var title="">byte</var>.
</ol>

<p>The <dfn id="single-byte-encoder">single-byte encoder</dfn> (<a href="#encoder">encoder</a> for
<a href="#single-byte-encoding" title="single-byte encoding">single-byte encodings</a>) is:

<ol>
 <li><p>Let <var title="">code point</var> be <a href="#code-point-pointer">code point pointer</a>.

 <li><p>If <var title="">code point</var> is the <a href="#eof-code-point">EOF code point</a>,
 emit the <a href="#eof-byte">EOF byte</a>.

 <li><p>Increase the <a href="#code-point-pointer">code point pointer</a> by one.

 <li><p>If <var title="">code point</var> is in the range U+0000 to U+007F,
 emit a byte whose value is <var title="">code point</var>.

 <li><p>If <var title="">code point</var> is not listed in the
 <b title="">map</b>, this is an <a href="#encoder-error">encoder error</a>.

 <li><p>Emit the byte given in the <b title="">map</b> for
 <var title="">code point</var>.
</ol>

<hr>

<p class="note">See also:
<a href="single-byte-research.html">single-byte research</a>.

<p class="note"><a href="#single-byte-encoding">Single-byte encoding</a> map data is also available
as a non-normative JSON resource:
<a href="single-byte-encodings.json"><code>single-byte-encodings.json</code></a>.


<h2 id="legacy-multi-byte-chinese-(simplified)-encodings"><span class="secno">8 </span>Legacy multi-byte Chinese (simplified) encodings</h2>

<p>The <dfn id="gbk-code-point">gbk code point</dfn> for a given number is: ...


<h3 id="gbk"><span class="secno">8.1 </span><dfn>gbk</dfn></h3>

<p>The <dfn id="gb18030-flag">gb18030 flag</dfn> flag is initially unset. It can only be set
by the <a href="#gb18030-decoder">gb18030 decoder</a> and <a href="#gb18030-encoder">gb18030 encoder</a>.

<p>The <dfn id="gb18030-range-table">gb18030 range table</dfn> is:

<table>
 <tr><th>Code point offset<th>From<th>To
 <tr><td>0x0452<!--200F--><td>0x81 0x30 0xD3 0x30<td>0x81 0x36 0xA5 0x31
 <tr><td>0x2643<!--2E80--><td>0x81 0x37 0xA8 0x39<td>0x81 0x38 0xFD 0x38
 <tr><td>0x361B<!--3917--><td>0x82 0x30 0xA6 0x33<td>0x82 0x30 0xF2 0x37
 <tr><td>0x3CE1<!--4055--><td>0x82 0x31 0xD4 0x38<td>0x82 0x32 0xAF 0x32
 <tr><td>0x4160<!--4336--><td>0x82 0x32 0xC9 0x37<td>0x82 0x32 0xF8 0x37
 <tr><td>0x44D7<!--464B--><td>0x82 0x33 0xA3 0x39<td>0x82 0x33 0xC9 0x31
 <tr><td>0x478E<!--4946--><td>0x82 0x33 0xE8 0x38<td>0x82 0x34 0x96 0x38
 <tr><td>0x49B8<!--4C76--><td>0x82 0x34 0xA1 0x31<td>0x82 0x34 0xE7 0x33
 <tr><td>0x9FA6<!--D7FF--><td>0x82 0x35 0x8F 0x33<td>0x83 0x36 0xC7 0x38
 <tr><td>0xE865<!--F92B--><td>0x83 0x36 0xD0 0x30<td>0x84 0x30 0x85 0x34
 <tr><td>0xFA2A<!--FE2F--><td>0x84 0x30 0x9C 0x38<td>0x84 0x31 0x85 0x37
 <tr><td>0xFFE6<!--FFFF--><td>0x84 0x31 0xA2 0x34<td>0x84 0x31 0xA4 0x39
 <tr><td>0x10000<!--10FFFF--><td>0x90 0x30 0x81 0x30<td>0xE3 0x32 0x9A 0x35
</table>

<p>The <dfn id="gbk-first">gbk first</dfn>, <dfn id="gbk-second">gbk second</dfn>, and
<dfn id="gbk-third">gbk third</dfn>, are all initially 0x00.

<p>The <dfn id="gbk-decoder">gbk decoder</dfn> (<a href="#decoder">decoder</a> for <a href="#gbk">gbk</a>) is:

<ol>
 <li><p>Let <var title="">byte</var> be <a href="#byte-pointer">byte pointer</a>.

 <li><p>If <var title="">byte</var> is the <a href="#eof-byte">EOF byte</a> and
 <a href="#gbk-first">gbk first</a>, <a href="#gbk-second">gbk second</a>, and <a href="#gbk-third">gbk third</a>
 are 0x00, emit the <a href="#eof-code-point">EOF code point</a>.

 <li><p>If <var title="">byte</var> is the <a href="#eof-byte">EOF byte</a>, and
 <a href="#gbk-first">gbk first</a>, <a href="#gbk-second">gbk second</a>, or <a href="#gbk-third">gbk third</a>
 is not 0x00, set <a href="#gbk-first">gbk first</a>, <a href="#gbk-second">gbk second</a>, and
 <a href="#gbk-third">gbk third</a> to 0x00; this is a <a href="#decoder-error">decoder error</a>.

 <li><p>Increase the <a href="#byte-pointer">byte pointer</a>.

 <li>
  <p>If <a href="#gbk-third">gbk third</a> is not 0x00, run these substeps:

  <ol>
   <li class="XXX"><p>If <var title="">byte</var> is in the range 0x30 to 0x39,
   ... and there is a code point ...
   set <a href="#gbk-first">gbk first</a>, <a href="#gbk-second">gbk second</a>, and
   <a href="#gbk-third">gbk third</a> to 0x00, and then
   emit ...

   <li><p>Decrease the <a href="#byte-pointer">byte pointer</a> by three, set
   <a href="#gbk-first">gbk first</a>, <a href="#gbk-second">gbk second</a>, and
   <a href="#gbk-third">gbk third</a> to 0x00; this is <a href="#decoder-error">decoder error</a>.
  </ol>

 <li>
  <p>If <a href="#gbk-second">gbk second</a> is not 0x00, run these substeps:

  <ol>
   <li><p>If <var title="">byte</var> is in the range 0x81 to 0xFE, set
   <a href="#gbk-third">gbk third</a> to <var title="">byte</var> and continue.

   <li><p>Decrease the <a href="#byte-pointer">byte pointer</a> by two, set
   <a href="#gbk-first">gbk first</a> and <a href="#gbk-second">gbk second</a> to 0x00; this is a
   <a href="#decoder-error">decoder error</a>.
  </ol>

 <li>
  <p>If <a href="#gbk-first">gbk first</a> is not 0x00, run these substeps:

  <ol>
   <li><p>If <var title="">byte</var> is in the range 0x30 to 0x39 and the
   <a href="#gb18030-flag">gb18030 flag</a> is set, set <a href="#gbk-second">gbk second</a> to
   <var title="">byte</var> and continue.

   <li class="XXX"><p>If <var title="">byte</var> is in the range 0x40 to 0xFE,
   ... and there is a code point ... set <a href="#gbk-first">gbk first</a> to 0x00, and
   then emit ...

   <li><p>Decrease the <a href="#byte-pointer">byte pointer</a> by one, set
   <a href="#gbk-first">gbk first</a> to 0x00; this is a <a href="#decoder-error">decoder error</a>.
  </ol>

 <li><p>If <var title="">byte</var> is in the range 0x00 to 0x7F, emit a code
 point whose value is <var title="">byte</var>.

 <li>
  <p>If <var title="">byte</var> is 0x80 and the <a href="#gb18030-flag">gb18030 flag</a> is
  unset, emit a code point whose value is U+20AC.

  <p class="XXX">Gecko emits it regardless of the <a href="#gb18030-flag">gb18030 flag</a>.

 <li><p>If <var title="">byte</var> is in the range 0x81 to 0xFE, set
 <a href="#gbk-first">gbk first</a> to <var title="">byte</var> and continue.

 <li><p>This is a <a href="#decoder-error">decoder error</a>.
</ol>

<p>The <dfn id="gbk-encoder">gbk encoder</dfn> (<a href="#encoder">encoder</a> for <a href="#gbk">gbk</a>) is:

<ol class="XXX"></ol>

<h3 id="gb18030"><span class="secno">8.2 </span><dfn>gb18030</dfn></h3>

<p>The <dfn id="gb18030-decoder">gb18030 decoder</dfn> (<a href="#decoder">decoder</a> for <a href="#gb18030">gb18030</a>) is
the <a href="#gbk-decoder">gbk decoder</a> with the <a href="#gb18030-flag">gb18030 flag</a> set.

<p>The <dfn id="gb18030-encoder">gb18030 encoder</dfn> (<a href="#encoder">encoder</a> for <a href="#gb18030">gb18030</a>) is
the <a href="#gbk-encoder">gbk encoder</a> with the <a href="#gb18030-flag">gb18030 flag</a> set.


<h3 id="hz-gb-2312"><span class="secno">8.3 </span><dfn>hz-gb-2312</dfn></h3>
<!--
 http://tools.ietf.org/html/rfc1842
 http://tools.ietf.org/html/rfc1843
-->

<p>The <dfn id="hz-gb-2312-flag">hz-gb-2312 flag</dfn> is initially unset. The
<dfn id="hz-gb-2312-lead">hz-gb-2312 lead</dfn> is initially 0x00.</p>

<p>The <dfn id="hz-gb-2312-decoder">hz-gb-2312 decoder</dfn> (<a href="#decoder">decoder</a> for <a href="#hz-gb-2312">hz-gb-2312</a>) is:

<ol>
 <li><p>Let <var title="">byte</var> be <a href="#byte-pointer">byte pointer</a>.

 <li><p>If <var title="">byte</var> is the <a href="#eof-byte">EOF byte</a> and
 <a href="#hz-gb-2312-lead">hz-gb-2312 lead</a> is 0x00, emit the
 <a href="#eof-code-point">EOF code point</a>.

 <li><p>If <var title="">byte</var> is the <a href="#eof-byte">EOF byte</a> and
 <a href="#hz-gb-2312-lead">hz-gb-2312 lead</a> is not 0x00, set <a href="#hz-gb-2312-lead">hz-gb-2312 lead</a>
 to 0x00; this is a <a href="#decoder-error">decoder error</a>.

 <li><p>Increase the <a href="#byte-pointer">byte pointer</a>.

 <li>
  <p>If <a href="#hz-gb-2312-lead">hz-gb-2312 lead</a> is 0x7E, set
  <a href="#hz-gb-2312-lead">hz-gb-2312 lead</a> to 0x00, and based on <var title="">byte</var>:

  <dl class="switch">
   <dt>0x7B<!--{-->
   <dd><p>Set the <a href="#hz-gb-2312-flag">hz-gb-2312 flag</a> and continue.

   <dt>0x7D<!--}-->
   <dd><p>Unset the <a href="#hz-gb-2312-flag">hz-gb-2312 flag</a> and continue.
   <!--In "ASCII mode" IE outputs ~}, Gecko outputs U+FFFD, Chrome outputs
   a single U+FFFD for ~}~}. Weird. Opera just skips.-->

   <dt>0x7E<!--~-->
   <dd><p>Emit a U+007E code point.

   <dt>0x0A<!--newline-->
   <dd><p>Set <a href="#hz-gb-2312-lead">hz-gb-2312 lead</a> to 0x00 and continue.

   <dt>Otherwise
   <dd><p>Decrease the <a href="#byte-pointer">byte pointer</a> by one; this is a
   <a href="#decoder-error">decoder error</a>.
  </dl>

 <li>
  <p>If <a href="#hz-gb-2312-lead">hz-gb-2312 lead</a> is not 0x00, set
  <a href="#hz-gb-2312-lead">hz-gb-2312 lead</a> to 0x00 and:

  <ol>
   <li><p class="XXX">Let <var title="">code point</var> be
   <a href="#gbk-code-point">gbk code point</a> for ...
   <!-- (hz-gb-2312 lead - 1) * 191 + (byte + 0x40) -->

   <li><p>If <var title="">byte</var> is in the range 0x20 to 0x7F and
   <var title="">code point</var> is not null, emit
   <var title="">code point</var>.

   <li><p>If <var title="">byte</var> is 0x0A, unset the
   <a href="#hz-gb-2312-flag">hz-gb-2312 flag</a>.

   <li><p>This is a <a href="#decoder-error">decoder error</a>.
  </ol>

 <li><p>If <var title="">byte</var> is 0x7E<!--~-->, set
 <a href="#hz-gb-2312-lead">hz-gb-2312 lead</a> to 0x7E and continue.

 <li>
  <p>If the <a href="#hz-gb-2312-flag">hz-gb-2312 flag</a> is set:

  <ol>
   <li><p>If <var title="">byte</var> is in the range 0x20 to 0x7F, set
   <a href="#hz-gb-2312-lead">hz-gb-2312 lead</a> to <var title="">byte</var> and continue.

   <li><p>If <var title="">byte</var> is 0x0A, unset the
   <a href="#hz-gb-2312-flag">hz-gb-2312 flag</a>.

   <li><p>This is a <a href="#decoder-error">decoder error</a>.
  </ol>

 <li><p>If <var title="">byte</var> is in the range 0x00 to 0x7F, emit a
 code point whose value is <var title="">byte</var>.

 <li><p>This is a <a href="#decoder-error">decoder error</a>.
</ol>

<p>The <dfn id="hz-gb-2312-encoder">hz-gb-2312 encoder</dfn> (<a href="#encoder">encoder</a> for <a href="#hz-gb-2312">hz-gb-2312</a>) is:

<ol class="XXX"></ol>


<h3 id="iso-2022-cn"><span class="secno">8.4 </span><dfn>iso-2022-cn</dfn></h3>
<!-- http://tools.ietf.org/html/rfc1922 -->

<p class="XXX">It has been suggested to remove this encoding from the platform
altogether as Internet Explorer treats it as unrecognized.


<h2 id="legacy-multi-byte-chinese-(traditional)-encodings"><span class="secno">9 </span>Legacy multi-byte Chinese (traditional) encodings</h2>

<!--
 Lead:  0x81 to 0xFE
 Trail: 0x40 to 0x7E or 0xA1 to 0xFE
-->


<h3 id="big5"><span class="secno">9.1 </span><dfn>big5</dfn></h3>

<p class="XXX">The <dfn id="big5-code-point">big5 code point</dfn> for <var title="">index</var> is
the code point located at <var title="">index</var> in ... or null if there is
no code point defined.

<p class="note">This index is the Big5 standard in combination with the
Hong Kong Supplementary Character Set.


<p>The <dfn id="big5-lead">big5 lead</dfn> is initially 0x00.

<p>The <dfn id="big5-decoder">big5 decoder</dfn> (<a href="#decoder">decoder</a> for <a href="#big5">big5</a>) is:

<ol>
 <li><p>Let <var title="">byte</var> be <a href="#byte-pointer">byte pointer</a>.

 <li><p>If <var title="">byte</var> is the <a href="#eof-byte">EOF byte</a> and
 <a href="#big5-lead">big5 lead</a> is 0x00, emit the
 <a href="#eof-code-point">EOF code point</a>.

 <li><p>If <var title="">byte</var> is the <a href="#eof-byte">EOF byte</a>,
 <a href="#big5-lead">big5 lead</a> is not 0x00, set <a href="#big5-lead">big5 lead</a> to 0x00;
 this is a <a href="#decoder-error">decoder error</a>.

 <li><p>Increase the <a href="#byte-pointer">byte pointer</a> by one.

 <li>
  <p>If <a href="#big5-lead">big5 lead</a> is not 0x00, let <var title="">lead</var> be
  <a href="#big5-lead">big5 lead</a>, let <var title="">index</var> be null, set
  <a href="#big5-lead">big5 lead</a> to 0x00, and then run these substeps:

  <ol>
   <li>
    <p>If there is a row in the table below whose first column contains
    <var title="">lead</var> and second column contains <var title="">byte</var>,
    emit the <em>two</em> code points listed in its third column:

    <table>
     <tr><td>0x88<td>0x62<td>U+00CA U+0304<!-- Ê̄ -->
     <tr><td>0x88<td>0x64<td>U+00CA U+030C<!-- Ê̌ -->
     <tr><td>0x88<td>0xA3<td>U+00EA U+0304<!-- ê̄ -->
     <tr><td>0x88<td>0xA5<td>U+00EA U+030C<!-- ê̌ -->
    </table>
    <!-- we do this to avoid PUA -->

   <li><p>Let <var title="">offset</var> be 0x62 if <var title="">byte</var> is
   greater than 0x7F, or 0x40 otherwise.
   <!-- 0x62 = 0xA1-0x7E+1+0x40 -->

   <li><p>If <var title="">byte</var> is in the range 0x40 to 0x7E or
   0xA1 to 0xFE, set <var title="">index</var> to
   (<var title="">lead</var> − 0x81) × 157 + (<var title="">byte</var> − <var title="">offset</var>).

   <li><p>Let <var title="">code point</var> be null if <var title="">index</var>
   is null, or the <a href="#big5-code-point">big5 code point</a> at <var title="">index</var>
   otherwise.

   <li><p>If <var title="">index</var> is null, decrease the
   <a href="#byte-pointer">byte pointer</a> by one.

   <li><p>If <var title="">code point</var> is null, this is a
   <a href="#decoder-error">decoder error</a>.

   <li><p>Emit a code point whose value is <var title="">code point</var>.
  </ol>

 <li><p>If <var title="">byte</var> is in the range 0x00 to 0x7F, emit a code
 point whose value is <var title="">byte</var>.

 <li><p>If <var title="">byte</var> is in the range 0x81 to 0xFE, set
 <a href="#big5-lead">big5 lead</a> to <var title="">byte</var> and continue.

 <li><p>This is a <a href="#decoder-error">decoder error</a>.
</ol>

<p>The <dfn id="big5-encoder">big5 encoder</dfn> (<a href="#encoder">encoder</a> for <a href="#big5">big5</a>) is:

<ol class="XXX"></ol>


<h2 id="legacy-multi-byte-japanese-encodings"><span class="secno">10 </span>Legacy multi-byte Japanese encodings</h2>

<p>Japanese encodings rely on two indexes,
<a href="index-jis0208.txt">index-jis0208.txt</a> and
<a href="index-jis0212.txt">index-jis0212.txt</a>. An index is a
newline-separated (U+000A) resource, where each line starts with a decimal
number representing a location, followed by a U+0009 code point, followed by
a hexadecimal number representing a code point, followed by a U+0009
code point, followed by the Unicode Character Name preceded by a U+0023
code point.

<p class="note">The first index differs from the similarly named JIS 0208
standard due to including formerly proprietary extensions from the
Nippon Electronics Corporation (NEC).
The second index is identical to the similarly named JIS 0212 standard.

<p>The <dfn id="jis0208-code-point">jis0208 code point</dfn> for
(<var title="">row</var>, <var title="">cell</var>) is the code point located
at <var title="">row</var> * 94 + <var title="">cell</var> in
<a href="index-jis0208.txt">index-jis0208.txt</a>, or null if there is no
code point defined.

<p>The <dfn id="jis0212-code-point">jis0212 code point</dfn> for
(<var title="">row</var>, <var title="">cell</var>) is the code point located
at <var title="">row</var> * 94 + <var title="">cell</var> in
<a href="index-jis0212.txt">index-jis0212.txt</a>, or null if there is no
code point defined.


<h3 id="euc-jp"><span class="secno">10.1 </span><dfn>euc-jp</dfn></h3>

<!-- http://www.iana.org/assignments/charset-reg/CP51932 -->

<p>The <dfn id="euc-jp-first">euc-jp first</dfn> and <dfn id="euc-jp-second">euc-jp second</dfn> are 0x00.

<p>The <dfn id="euc-jp-decoder">euc-jp decoder</dfn> (<a href="#decoder">decoder</a> for <a href="#euc-jp">euc-jp</a>) is:

<ol>
 <li><p>Let <var title="">byte</var> be <a href="#byte-pointer">byte pointer</a>.

 <li><p>If <var title="">byte</var> is the <a href="#eof-byte">EOF byte</a> and
 <a href="#euc-jp-first">euc-jp first</a> and <a href="#euc-jp-second">euc-jp second</a> are 0x00, emit the
 <a href="#eof-code-point">EOF code point</a>.

 <li><p>If <var title="">byte</var> is the <a href="#eof-byte">EOF byte</a> and either
 <a href="#euc-jp-first">euc-jp first</a> or <a href="#euc-jp-second">euc-jp second</a> is not 0x00, set
 <a href="#euc-jp-first">euc-jp first</a> and <a href="#euc-jp-second">euc-jp second</a> to 0x00;
 this is a <a href="#decoder-error">decoder error</a>.

 <li><p>Increase the <a href="#byte-pointer">byte pointer</a> by one.

 <li>
  <p>If <a href="#euc-jp-second">euc-jp second</a> is not 0x00, let <var title="">lead</var> be
  <a href="#euc-jp-second">euc-jp second</a>, set <a href="#euc-jp-second">euc-jp second</a> to 0x00 and run
  these substeps:

  <ol>
   <li><p>Let <var title="">code point</var> be null.

   <li><p>If <var title="">lead</var> and <var title="">byte</var> are both in the
   range 0xA1 to 0xFE, set <var title="">code point</var> to the
   <a href="#jis0212-code-point">jis0212 code point</a> for
   (<var title="">lead</var> − 0xA1, <var title="">byte</var> − 0xA1).

   <li><p>If <var title="">code point</var> is null and <var title="">byte</var>
   is not in the range 0xA1 to 0xFE, decrease <a href="#byte-pointer">byte pointer</a> by
   one.

   <li><p>If <var title="">code point</var> is null, this is a
   <a href="#decoder-error">decoder error</a>.

   <li><p>Emit <var title="">code point</var>.
  </ol>

 <li><p>If <a href="#euc-jp-first">euc-jp first</a> is 0x8E and <var title="">byte</var> is
 in the range 0xA1 to 0xDF, set <a href="#euc-jp-first">euc-jp first</a> to 0x00 and emit
 a code point whose value is 0xFEC0 + <var title="">byte</var>.

 <li><p>If <a href="#euc-jp-first">euc-jp first</a> is 0x8F and <var title="">byte</var> is
 in the range 0xA1 to 0xFE, set <a href="#euc-jp-first">euc-jp first</a> to 0x00,
 <a href="#euc-jp-second">euc-jp second</a> to <var title="">byte</var>, and continue.

 <li><p>If <a href="#euc-jp-first">euc-jp first</a> is not 0x00, let <var title="">lead</var>
 be <a href="#euc-jp-first">euc-jp first</a>, set <a href="#euc-jp-first">euc-jp first</a> to 0x00, and
 run these substeps:

  <ol>
   <li><p>Let <var title="">code point</var> be null.

   <li><p>If <var title="">lead</var> and <var title="">byte</var> are both in the
   range 0xA1 to 0xFE, set <var title="">code point</var> to the
   <a href="#jis0208-code-point">jis0208 code point</a> for
   (<var title="">lead</var> − 0xA1, <var title="">byte</var> − 0xA1).

   <li><p>If <var title="">code point</var> is null and <var title="">byte</var>
   is not in the range 0xA1 to 0xFE, decrease <a href="#byte-pointer">byte pointer</a> by
   one.

   <li><p>If <var title="">code point</var> is null, this is a
   <a href="#decoder-error">decoder error</a>.

   <li><p>Emit <var title="">code point</var>.
  </ol>

 <li><p>If <var title="">byte</var> is in the range 0x00 to 0x7F, emit a
 code point whose value is <var title="">byte</var>.

 <li><p>If <var title="">byte</var> is 0x8E, 0x8F, or in the range 0xA1 to
 0xFE, set <a href="#euc-jp-first">euc-jp first</a> to <var title="">byte</var> and continue.

 <li><p>This is a <a href="#decoder-error">decoder error</a>.
</ol>

<p>The <dfn id="euc-jp-encoder">euc-jp encoder</dfn> (<a href="#encoder">encoder</a> for <a href="#euc-jp">euc-jp</a>) is:

<ol class="XXX">
</ol>

<p class="XXX">https://bugzilla.mozilla.org/show_bug.cgi?id=600715 encoder is more restrictive.


<h3 id="iso-2022-jp"><span class="secno">10.2 </span><dfn>iso-2022-jp</dfn></h3>
<!--
 http://tools.ietf.org/html/rfc1468
 http://tools.ietf.org/html/rfc2237 (iso-2022-jp-1)
-->

<p>The <dfn id="iso-2022-jp-state">iso-2022-jp state</dfn> is initially <b title="">ASCII state</b>.

<p>The <dfn id="iso-2022-jp-jis0212-flag">iso-2022-jp jis0212 flag</dfn> is initially unset.

<p>The <dfn id="iso-2022-jp-lead">iso-2022-jp lead</dfn> is initially 0x00.

<p>The <dfn id="iso-2022-jp-decoder">iso-2022-jp decoder</dfn> (<a href="#decoder">decoder</a> for <a href="#iso-2022-jp">iso-2022-jp</a>) is:

<ol>
 <li><p>Let <var title="">byte</var> be <a href="#byte-pointer">byte pointer</a>.

 <li><p>If <var title="">byte</var> is not the <a href="#eof-byte">EOF byte</a>,
 increase the <a href="#byte-pointer">byte pointer</a> by one.

 <li>
  <p>Based on <a href="#iso-2022-jp-state">iso-2022-jp state</a>:

  <dl class="switch">
   <dt>ASCII state

   <dd>
    <p>Based on <var title="">byte</var>:

    <dl class="switch">
     <dt>0x1B
     <dd><p>Set <a href="#iso-2022-jp-state">iso-2022-jp state</a> to
     <b title="">escape start state</b> and continue.

     <dt>0x00 to 0x7E
     <dd><p>Emit a code point whose value is <var title="">byte</var>.

     <dt><a href="#eof-byte">EOF byte</a>
     <dd><p>Emit the <a href="#eof-code-point">EOF code point</a>.

     <dt>Otherwise
     <dd><p>This is a <a href="#decoder-error">decoder error</a>.
    </dl>

   <dt>Escape start state
   <dd>
    <ol>
     <li><p>If <var title="">byte</var> is either <!--$-->0x24 or
     <!--(-->0x28, set <a href="#iso-2022-jp-lead">iso-2022-jp lead</a> to
     <var title="">byte</var>, <a href="#iso-2022-jp-state">iso-2022-jp state</a> to
     <b title="">escape middle state</b>, and continue.

     <li><p>If <var title="">byte</var> is not the <a href="#eof-byte">EOF byte</a>,
     decrease the <a href="#byte-pointer">byte pointer</a> by one.

     <li><p>Set <a href="#iso-2022-jp-state">iso-2022-jp state</a> to <b title="">ASCII state</b>;
     this is a <a href="#decoder-error">decoder error</a>.
    </ol>

   <dt>Escape middle state
   <dd>
    <ol>
     <li><p>Let <var title="">lead</var> be <a href="#iso-2022-jp-lead">iso-2022-jp lead</a> and
     set <a href="#iso-2022-jp-lead">iso-2022-jp lead</a> to 0x00.

     <li><p>If <var title="">lead</var> is 0x24 and <var title="">byte</var> is
     either 0x40<!--@--> or 0x42<!--B-->, unset the
     <a href="#iso-2022-jp-jis0212-flag">iso-2022-jp jis0212 flag</a>, set
     <a href="#iso-2022-jp-state">iso-2022-jp state</a> to <b title="">lead state</b>, and
     continue.

     <li><p>If <var title="">lead</var> is 0x24 and <var title="">byte</var> is
     0x28, set <a href="#iso-2022-jp-state">iso-2022-jp state</a> to
     <b title="">escape final state</b> and continue.

     <li><p>If <var title="">lead</var> is 0x28 and <var title="">byte</var> is
     either 0x42<!--B--> or 0x4A<!--J-->, set <a href="#iso-2022-jp-state">iso-2022-jp state</a>
     to <b title="">ASCII state</b> and continue.

     <li><p>If <var title="">lead</var> is 0x28 and <var title="">byte</var> is
     0x49<!--I-->, set <a href="#iso-2022-jp-state">iso-2022-jp state</a> to
     <b title="">Katakana state</b> and continue.

     <li><p>If <var title="">byte</var> is the <a href="#eof-byte">EOF byte</a>,
     decrease <a href="#byte-pointer">byte pointer</a> by one, or otherwise decrease it by
     two.

     <li><p>Set <a href="#iso-2022-jp-state">iso-2022-jp state</a> to <b title="">ASCII state</b>;
     this is a <a href="#decoder-error">decoder error</a>.
    </ol>

   <dt>Escape final state
   <dd>
    <ol>
     <li><p>If <var title="">byte</var> is 0x44<!--D-->, set the
     <a href="#iso-2022-jp-jis0212-flag">iso-2022-jp jis0212 flag</a>, set
     <a href="#iso-2022-jp-state">iso-2022-jp state</a> to <b title="">lead state</b>, and
     continue.

     <li><p>If <var title="">byte</var> is the <a href="#eof-byte">EOF byte</a>,
     decrease <a href="#byte-pointer">byte pointer</a> by two, or otherwise decrease it by
     three.

     <li><p>Set <a href="#iso-2022-jp-state">iso-2022-jp state</a> to <b title="">ASCII state</b>;
     this is a <a href="#decoder-error">decoder error</a>.
    </ol>

   <dt>Lead state
   <dd>
    <p>Based on <var title="">byte</var>:
    <dl class="switch">
     <dt>0x0A
     <dd><p>Set <a href="#iso-2022-jp-state">iso-2022-jp state</a> to <b title="">ASCII state</b>;
     this is a <a href="#decoder-error">decoder error</a>; emit a code point whose value is
     U+000A.

     <dt>0x1B
     <dd><p>Set <a href="#iso-2022-jp-state">iso-2022-jp state</a> to
     <b title="">escape start state</b> and continue.

     <dt><a href="#eof-byte">EOF byte</a>
     <dd><p>Emit the <a href="#eof-code-point">EOF code point</a>.

     <dt>Otherwise
     <dd><p>Set <a href="#iso-2022-jp-lead">iso-2022-jp lead</a> to <var title="">byte</var>,
     <a href="#iso-2022-jp-state">iso-2022-jp state</a> to <b title="">trail state</b>, and
     continue.
    </dl>

   <dt>Trail state
   <dd>
    <ol>
     <li><p>Set the <a href="#iso-2022-jp-state">iso-2022-jp state</a> to
     <b title="">lead state</b>.

     <li><p>If <var title="">byte</var> is the <a href="#eof-byte">EOF byte</a>, this is a
     <a href="#decoder-error">decoder error</a>.

     <li><p>Let <var title="">code point</var> be null.

     <li><p>If <a href="#iso-2022-jp-lead">iso-2022-jp lead</a> and <var title="">byte</var> are
     both in the range 0x21 to 0x7E: Set <var title="">code point</var> to
     the <a href="#jis0208-code-point">jis0208 code point</a> for
     (<a href="#iso-2022-jp-lead">iso-2022-jp lead</a> − 0x21, <var title="">byte</var> − 0x21) if
     the <a href="#iso-2022-jp-jis0212-flag">iso-2022-jp jis0212 flag</a> is unset, or to the
     <a href="#jis0212-code-point">jis0212 code point</a> for
     (<a href="#iso-2022-jp-lead">iso-2022-jp lead</a> − 0x21, <var title="">byte</var> − 0x21) if
     the <a href="#iso-2022-jp-jis0212-flag">iso-2022-jp jis0212 flag</a> is set.

     <li><p>If <var title="">code point</var> is null, this is a
     <a href="#decoder-error">decoder error</a>.

     <li><p>Emit <var title="">code point</var>.
    </ol>

   <dt>Katakana state
   <dd>
    <p>Based on <var title="">byte</var>:
    <dl class="switch">
     <dt>0x1B
     <dd><p>Set <a href="#iso-2022-jp-state">iso-2022-jp state</a> to
     <b title="">escape start state</b> and continue.

     <dt>0x21 to 0x5F
     <dd><p>Emit a code point whose value is 0xFF40 + <var title="">byte</var>.

     <dt><a href="#eof-byte">EOF byte</a>
     <dd><p>Emit the <a href="#eof-code-point">EOF code point</a>.

     <dt>Otherwise
     <dd><p>This is a <a href="#decoder-error">decoder error</a>.
    </dl>
  </dl>
</ol>

<p>The <dfn id="iso-2022-jp-encoder">iso-2022-jp encoder</dfn> (<a href="#encoder">encoder</a> for <a href="#iso-2022-jp">iso-2022-jp</a>) is:

<ol class="XXX"></ol>


<h3 id="shift_jis"><span class="secno">10.3 </span><dfn>shift_jis</dfn></h3>

<p>The <dfn id="shift_jis-fallback-code-point">shift_jis fallback code point</dfn> is U+30FB.</p>

<p>The <dfn id="shift_jis-lead">shift_jis lead</dfn> is initially 0x00.

<p>The <dfn id="shift_jis-decoder">shift_jis decoder</dfn> (<a href="#decoder">decoder</a> for <a href="#shift_jis">shift_jis</a>) is:

<ol>
 <li><p>Let <var title="">byte</var> be <a href="#byte-pointer">byte pointer</a>.

 <li><p>If <var title="">byte</var> is the <a href="#eof-byte">EOF byte</a> and
 <a href="#shift_jis-lead">shift_jis lead</a> is 0x00, emit the
 <a href="#eof-code-point">EOF code point</a>.

 <li><p>If <var title="">byte</var> is the <a href="#eof-byte">EOF byte</a>,
 <a href="#shift_jis-lead">shift_jis lead</a> is not 0x00, set <a href="#shift_jis-lead">shift_jis lead</a> to
 0x00; this is a <a href="#decoder-error">decoder error</a>.

 <li><p>Increase the <a href="#byte-pointer">byte pointer</a> by one.

 <li>
  <p>If <a href="#shift_jis-lead">shift_jis lead</a> is not 0x00, let <var title="">lead</var>
  be <a href="#shift_jis-lead">shift_jis lead</a>, set <a href="#shift_jis-lead">shift_jis lead</a> to 0x00,
  and then run these substeps:

  <ol>
   <li>
    <p>If <var title="">byte</var> is in the range 0x40 to 0x7E or
    0x80 to 0xFC, run these substeps:

    <ol>
     <li><p>Set <var title="">offset</var> to 64 if <var title="">byte</var> is
     less than 0x7F, or 65 otherwise.
     <!-- offset = byte > 127 ? 65 : 64 -->

     <li><p>If <var title="">lead</var> is in the range 0xF0 to 0xF9, this is a
     <a href="#decoder-error">decoder error</a>; emit a code point whose value is
     0xE000 + (<var title="">lead</var> − 0xF0) × 188 +
     <var title="">byte</var> − <var title="">offset</var>.

     <!--JAPANESE DRAGONS (more scary and crazy)-->

     <li><p>Let <var title="">adjust</var> be 0, or 1 if <var title="">byte</var>
     is less than 0x9F.
     <!-- adjust = byte < 159 -->

     <li><p>Let <var title="">lead offset</var> be 176, or 112 if
     <var title="">lead</var> is less than 160.
     <!-- lead offset = lead < 160 ? 112 : 176 -->

     <li><p>If <var title="">adjust</var> is 0, set <var title="">offset</var> to
     159.
     <!-- offset = adjust ? offset : 159 -->

     <li><p>Let <var title="">row</var> be the arithmetic left shift of
     <var title="">lead</var> − <var title="">lead offset</var> by 1.
     <li><p>Set <var title="">row</var> to
     <var title="">row</var> − <var title="">adjust</var> − 33.
     <!-- row = ((lead - lead offset) << 1) - adjust - 33 -->

     <li><p>Let <var title="">code point</var>  be the
     <a href="#jis0208-code-point">jis0208 code point</a> for
     (<var title="">row</var>, <var title="">byte</var> − <var title="">offset</var>).
     <!-- cell = byte - offset -->

     <li>
      <p>If <var title="">code point</var> is null, this is a
      <a href="#decoder-error">decoder error</a>; emit the
      <a href="#shift_jis-fallback-code-point">shift_jis fallback code point</a>.

      <p class="note">This is not your normal <a href="#fallback-code-point">fallback code point</a>!

     <li><p>Emit <var title="">code point</var>.
    </ol>

   <li><p>Decrease the <a href="#byte-pointer">byte pointer</a> by one; this is a
   <a href="#decoder-error">decoder error</a>.
  </ol>

 <li><p>If <var title="">byte</var> is in the range 0x00 to 0x80, emit a
 code point whose value is <var title="">byte</var>.
 <!-- Opera has 0x7E -->

 <li><p>If <var title="">byte</var> is 0xA0, emit U+F8F0.

 <li><p>If <var title="">byte</var> is in the range 0xA1 to 0xDF, emit a
 code point whose value is 0xFEC0 + <var title="">byte</var>.
 <!-- katakana -->

 <li><p>If <var title="">byte</var> is in the range 0xFD to 0xFF, emit a
 code point whose value is 0xF7F4 + <var title="">byte</var>.

 <li><p>If <var title="">byte</var> is in the range 0x81 to 0x9F or
 0xE0 to 0xFC, set <a href="#shift_jis-lead">shift_jis lead</a> to <var title="">byte</var> and
 continue.

 <li><p>This is a <a href="#decoder-error">decoder error</a>.
</ol>

<p>The <dfn id="shift_jis-encoder">shift_jis encoder</dfn> (<a href="#encoder">encoder</a> for <a href="#shift_jis">shift_jis</a>) is:

<ol class="XXX"></ol>



<h2 id="legacy-multi-byte-korean-encodings"><span class="secno">11 </span>Legacy multi-byte Korean encodings</h2>

<p>The <dfn id="euc-kr-code-point">euc-kr code point</dfn> for <var title="">index</var> is the
code point located at <var title="">index</var> in
<a href="index-euc-kr.txt">index-euc-kr.txt</a>, or null if there is no code
point defined.

<p class="note">This index is a combination of the KS X 1001 standard and the
Unified Hangul Code, more commonly known together as Windows Codepage 949.


<h3 id="euc-kr"><span class="secno">11.1 </span><dfn>euc-kr</dfn></h3>

<p>The <dfn id="euc-kr-lead">euc-kr lead</dfn> is initially 0x00.

<p>The <dfn id="euc-kr-decoder">euc-kr decoder</dfn> (<a href="#decoder">decoder</a> for <a href="#euc-kr">euc-kr</a>) is:

<ol>
 <li><p>Let <var title="">byte</var> be <a href="#byte-pointer">byte pointer</a>.

 <li><p>If <var title="">byte</var> is the <a href="#eof-byte">EOF byte</a> and
 <a href="#euc-kr-lead">euc-kr lead</a> is 0x00, emit the
 <a href="#eof-code-point">EOF code point</a>.

 <li><p>If <var title="">byte</var> is the <a href="#eof-byte">EOF byte</a> and
 <a href="#euc-kr-lead">euc-kr lead</a> is not 0x00, set <a href="#euc-kr-lead">euc-kr lead</a> to 0x00;
 this is a <a href="#decoder-error">decoder error</a>.

 <li><p>Increase the <a href="#byte-pointer">byte pointer</a> by one.

 <li>
  <p>If <a href="#euc-kr-lead">euc-kr lead</a> is not 0x00, let <var title="">lead</var> be
  <a href="#euc-kr-lead">euc-kr lead</a>, let <var title="">index</var> be null,
  set <a href="#euc-kr-lead">euc-kr lead</a> to 0x00, and then run these substeps:

  <ol>
   <li>
    <p>If <var title="">lead</var> is in the range 0x81 to 0xC6, let
    <var title="">temp</var> be
    (26 + 26 + 126) × (<var title="">lead</var> − 0x81), and then
    set <var title="">index</var> to the result of the equation below,
    depending on <var title="">byte</var>:

    <dl class="switch">
     <dt>0x41 to 0x5A
     <dd><p><var title="">temp</var> + <var title="">byte</var> − 0x41
     <dt>0x61 to 0x7A
     <dd><p><var title="">temp</var> + 26 + <var title="">byte</var> − 0x61
     <dt>0x81 to 0xFE
     <dd><p><var title="">temp</var> + 26 + 26 + <var title="">byte</var> − 0x81
    </dl>

   <li><p>If <var title="">lead</var> is in the range 0xC7 to 0xFD and
   <var title="">byte</var> is in the range 0xA1 to 0xFE, set
   <var title="">index</var> to
   (26 + 26 + 126) × (0xC7 − 0x81) + (<var title="">lead</var> − 0xC7) × 94 + (<var title="">byte</var> − 0xA1).

   <li><p>Let <var title="">code point</var> be null if <var title="">index</var>
   is null, or the <a href="#euc-kr-code-point">euc-kr code point</a> at <var title="">index</var>
   otherwise.

   <li><p>If <var title="">index</var> is null, decrease the
   <a href="#byte-pointer">byte pointer</a> by one.

   <li><p>If <var title="">code point</var> is null, this is a
   <a href="#decoder-error">decoder error</a>.

   <li><p>Emit a code point whose value is <var title="">code point</var>.
  </ol>

 <li><p>If <var title="">byte</var> is in the range 0x00 to 0x7F, emit a
 code point whose value is <var title="">byte</var>.

 <li><p>If <a href="#euc-kr-lead">euc-kr lead</a> is in the range 0x81 to 0xFD, set
 <a href="#euc-kr-lead">euc-kr lead</a> to <var title="">byte</var> and continue.

 <li><p>This is a <a href="#decoder-error">decoder error</a>.
</ol>

<p>The <dfn id="euc-kr-encoder">euc-kr encoder</dfn> (<a href="#encoder">encoder</a> for <a href="#euc-kr">euc-kr</a>) is:

<ol class="XXX"></ol>


<h3 id="iso-2022-kr"><span class="secno">11.2 </span><dfn>iso-2022-kr</dfn></h3>

<!--XXX the "ESC $ ) C" sequence is only supported by Gecko at the start of
a stream. It does exactly nothing. Trying to get away with not supporting it
at all.-->

<p>The <dfn id="iso-2022-kr-state">iso-2022-kr state</dfn> is initially <b title="">ASCII state</b>.

<p>The <dfn id="iso-2022-kr-lead">iso-2022-kr lead</dfn> is initially 0x00.

<p>The <dfn id="iso-2022-kr-decoder">iso-2022-kr decoder</dfn> (<a href="#decoder">decoder</a> for <a href="#iso-2022-kr">iso-2022-kr</a>) is:

<ol>
 <li><p>Let <var title="">byte</var> be <a href="#byte-pointer">byte pointer</a>.

 <li><p>If <var title="">byte</var> is not the <a href="#eof-byte">EOF byte</a>,
 increase the <a href="#byte-pointer">byte pointer</a> by one.

 <li>
  <p>Based on <a href="#iso-2022-kr-state">iso-2022-kr state</a>:

  <dl class="switch">
   <dt>ASCII state

   <dd>
    <p>Based on <var title="">byte</var>:

    <dl class="switch">
     <dt>0x0E
     <dd><p>Set <a href="#iso-2022-kr-state">iso-2022-kr state</a> to <b title="">lead state</b>
     and continue.

     <dt>0x0F
     <dd><p>Continue.

     <dt>0x00 to 0x7E
     <dd><p>Emit a code point whose value is <var title="">byte</var>.

     <dt><a href="#eof-byte">EOF byte</a>
     <dd><p>Emit the <a href="#eof-code-point">EOF code point</a>.

     <dt>Otherwise
     <dd><p>This is a <a href="#decoder-error">decoder error</a>.
    </dl>

   <dt>Lead state
   <dd>
    <p>Based on <var title="">byte</var>:
    <dl class="switch">
     <dt>0x0A
     <dd><p>Set <a href="#iso-2022-kr-state">iso-2022-kr state</a> to <b title="">ASCII state</b>;
     this is a <a href="#decoder-error">decoder error</a>; emit a code point whose value is
     U+000A.

     <dt>0x0E
     <dd><p>Continue.

     <dt>0x0F
     <dd><p>Set <a href="#iso-2022-kr-state">iso-2022-kr state</a> to <b title="">ASCII state</b>
     and continue.

     <dt><a href="#eof-byte">EOF byte</a>
     <dd><p>Emit the <a href="#eof-code-point">EOF code point</a>.

     <dt>Otherwise
     <dd><p>Set <a href="#iso-2022-kr-lead">iso-2022-kr lead</a> to <var title="">byte</var>, set
     <a href="#iso-2022-kr-state">iso-2022-kr state</a> to <b title="">trail state</b>, and
     continue.
    </dl>

   <dt>Trail state
   <dd>
    <ol>
     <li><p>Set the <a href="#iso-2022-kr-state">iso-2022-kr state</a> to
     <b title="">lead state</b>.

     <li><p>If <var title="">byte</var> is the <a href="#eof-byte">EOF byte</a>, this is a
     <a href="#decoder-error">decoder error</a>.

     <li><p>Let <var title="">code point</var> be null.

     <li><p>If <a href="#iso-2022-kr-lead">iso-2022-kr lead</a> is in the range 0x21 to 0x46
     and <var title="">byte</var> is in the range 0x21 to 0x7E, set
     <var title="">code point</var> to the <a href="#euc-kr-code-point">euc-kr code point</a> for
     (26 + 26 + 126) × (<a href="#iso-2022-kr-lead">iso-2022-kr lead</a> − 1) + 26 + 26 + <var title="">byte</var> − 1.

     <li><p>If <a href="#iso-2022-kr-lead">iso-2022-kr lead</a> is in the range 0x47 to 0x7E
     and <var title="">byte</var> is in the range 0x21 to 0x7E, set
     <var title="">code point</var> to the <a href="#euc-kr-code-point">euc-kr code point</a> for
     (26 + 26 + 126) × (0xC7 − 0x81) + (<a href="#iso-2022-kr-lead">iso-2022-kr lead</a> − 0x47) × 94 + (<var title="">byte</var> − 0x21)

     <li><p>If <var title="">code point</var> is not null, emit
     <var title="">code point</var>.

     <li><p>This is a <a href="#decoder-error">decoder error</a>.
    </ol>
  </dl>
</ol>

<p>The <dfn id="iso-2022-kr-encoder">iso-2022-kr encoder</dfn> (<a href="#encoder">encoder</a> for <a href="#iso-2022-kr">iso-2022-kr</a>) is:

<ol class="XXX"></ol>


<h2 id="legacy-utf-16-encodings"><span class="secno">12 </span>Legacy utf-16 encodings</h2>

<p class="note">Contrary to the Unicode standard, checking for a BOM happens
before an encoding to decode a byte stream is chosen.


<h3 id="utf-16"><span class="secno">12.1 </span><dfn>utf-16</dfn></h3>

<p>The <dfn id="utf-16-lead-byte">utf-16 lead byte</dfn> and <dfn id="utf-16-lead-surrogate">utf-16 lead surrogate</dfn>
are initially null and the <dfn id="utf-16be-flag">utf-16be flag</dfn> is initially unset.

<p>The <dfn id="utf-16-decoder">utf-16 decoder</dfn> (<a href="#decoder">decoder</a> for <a href="#utf-16">utf-16</a>) is:

<ol>
 <li><p>Let <var title="">byte</var> be <a href="#byte-pointer">byte pointer</a>.

 <li><p>If <var title="">byte</var> is the <a href="#eof-byte">EOF byte</a> and
 <a href="#utf-16-lead-byte">utf-16 lead byte</a> and <a href="#utf-16-lead-surrogate">utf-16 lead surrogate</a> are
 null, emit the <a href="#eof-code-point">EOF code point</a>.

 <li><p>If <var title="">byte</var> is the <a href="#eof-byte">EOF byte</a> and either
 <a href="#utf-16-lead-byte">utf-16 lead byte</a> or <a href="#utf-16-lead-surrogate">utf-16 lead surrogate</a> is not
 null, set <a href="#utf-16-lead-byte">utf-16 lead byte</a> and
 <a href="#utf-16-lead-surrogate">utf-16 lead surrogate</a> to null; this is a
 <a href="#decoder-error">decoder error</a>.

 <li><p>Increase the <a href="#byte-pointer">byte pointer</a> by one.

 <li><p>If <a href="#utf-16-lead-byte">utf-16 lead byte</a> is null, set
 <a href="#utf-16-lead-byte">utf-16 lead byte</a> to <var title="">byte</var> and continue.

 <li>
  <p>Let <var title="">code point</var> be the result of:

  <dl class="switch">
   <dt><a href="#utf-16be-flag">utf-16be flag</a> is set
   <dd><p>The arithmetic left shift of <a href="#utf-16-lead-byte">utf-16 lead byte</a> by 8 +
   <var title="">byte</var>.
   <dt><a href="#utf-16be-flag">utf-16be flag</a> is unset
   <dd><p>The arithmetic left shift of <var title="">byte</var> by 8 +
   <a href="#utf-16-lead-byte">utf-16 lead byte</a>.
  </dl>

  <p>Then set <a href="#utf-16-lead-byte">utf-16 lead byte</a> to null.

 <li>
  <p>If <a href="#utf-16-lead-surrogate">utf-16 lead surrogate</a> is not null, let
  <var title="">lead surrogate</var> be <a href="#utf-16-lead-surrogate">utf-16 lead surrogate</a>, set
  <a href="#utf-16-lead-surrogate">utf-16 lead surrogate</a> to null, and then run these substeps:

  <ol>
   <li><p>If <var title="">code point</var> is in the range U+DC00 to U+DFFF,
   emit a code point whose value is
   0x10000 + (<var title="">lead surrogate</var> − 0xD800) × 0x400 + (<var title="">code point</var> − 0xDC00).

   <li><p>Decrease the <a href="#byte-pointer">byte pointer</a> by two;
   this is a <a href="#decoder-error">decoder error</a>.
   <!-- unpaired surrogates; IE/WebKit output them, Gecko/Opera FFFD them -->
  </ol>

 <li><p>If <var title="">code point</var> is in the range U+D800 to U+DBFF, set
 <a href="#utf-16-lead-surrogate">utf-16 lead surrogate</a> to <var title="">code point</var> and
 continue.

 <li><p>If <var title="">code point</var> is in the range U+DC00 to U+DFFF,
 this is a <a href="#decoder-error">decoder error</a>.
 <!-- unpaired surrogates; IE/WebKit output them, Gecko/Opera FFFD them -->

 <li><p>Emit code point <var title="">code point</var>.
</ol>

<p>To <dfn id="convert-a-code-unit-to-bytes">convert a <var title="">code unit</var> to bytes</dfn> run these steps:

<ol>
 <li><p>Let <var title="">byte1</var> be the arithmetic right shift of
 <var title="">code point</var> by 8.

 <li><p>Let <var title="">byte2</var> be <var title="">code point</var>
 bitwise AND 0x00FF.

 <li>
  <p>Then return the bytes in order:

  <dl class="switch">
   <dt><a href="#utf-16be-flag">utf-16be flag</a> is set
   <dd><p><var title="">byte1</var>, then <var title="">byte2</var>.
   <dt><a href="#utf-16be-flag">utf-16be flag</a> is unset
   <dd><p><var title="">byte2</var>, then <var title="">byte1</var>.
  </dl>
</ol>

<p>The <dfn id="utf-16-encoder">utf-16 encoder</dfn> (<a href="#encoder">encoder</a> for <a href="#utf-16">utf-16</a>) is:

<ol>
 <li><p>Let <var title="">code point</var> be <a href="#code-point-pointer">code point pointer</a>.

 <li><p>If <var title="">code point</var> is in the range 0xD800 to 0xDFFF,
 this is an <a href="#encoder-error">encoder error</a>.

 <li><p>If <var title="">code point</var> is the <a href="#eof-code-point">EOF code point</a>,
 emit the <a href="#eof-byte">EOF byte</a>.

 <li><p>Increase the <a href="#code-point-pointer">code point pointer</a> by one.

 <li><p>If <var title="">code point</var> is in the range 0x00 to 0xFFFF, emit
 the sequence resulting of
 <a href="#convert-a-code-unit-to-bytes" title="convert a code unit to bytes">converting <var title="">code point</var> to bytes</a>.

 <li><p>Let <var title="">lead</var> be
 (<var title="">code point</var> − 0x10000) divided by 0x400 + 0xD800,
 <a href="#convert-a-code-unit-to-bytes" title="convert a code unit to bytes">converted to bytes</a>.

 <li><p>Let <var title="">trail</var> be the remainder of dividing
 (<var title="">code point</var> − 0x10000) by 0x400 + 0xDC00,
 <a href="#convert-a-code-unit-to-bytes" title="convert a code unit to bytes">converted to bytes</a>.

 <li><p>Emit a sequence of bytes that consists of <var title="">lead</var>
 followed by <var title="">trail</var>.
</ol>


<h3 id="utf-16be"><span class="secno">12.2 </span><dfn>utf-16be</dfn></h3>

<p>The <dfn id="utf-16be-decoder">utf-16be decoder</dfn> (<a href="#decoder">decoder</a> for <a href="#utf-16be">utf-16be</a>)
is the <a href="#utf-16-decoder">utf-16 decoder</a> with the <a href="#utf-16be-flag">utf-16be flag</a> set.

<p>The <dfn id="utf-16be-encoder">utf-16be encoder</dfn> (<a href="#encoder">encoder</a> for <a href="#utf-16be">utf-16be</a>)
is the <a href="#utf-16-encoder">utf-16 encoder</a> with the <a href="#utf-16be-flag">utf-16be flag</a> set.


<h2 class="no-num" id="references">References</h2>

<div id="anolis-references"><dl><dt id="refsRFC2119">[RFC2119]
<dd><cite><a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a></cite>, Scott Bradner. IETF.

</dl></div>


<h2 class="no-num" id="acknowledgments">Acknowledgments</h2>

<p>There have been a lot of people that have helped make encodings more
interoperable over the years and thereby furthered the goals of this
standard. Likewise people have helped making this standard what it is today.

<p>Ideally they are all listed here so please contact the editor with any
omissions.

<p>With that, many thanks to

Erik van der Poel,
譚永鋒 (Frank Yung-Fong Tang),
Ian Hickson,
Joshua Bell,
신정식 (Jungshik Shin),
Ken Lunde,
Mark Callow,
Mark Davis,
Martin Dürst,
Masatoshi Kimura,
Ms2ger,
Øistein E. Andersen,
Peter Krefting,
Philip Taylor,
Shawn Steele,
Simon Montagu,
Simon Pieters, and
成瀬ゆい (Yui Naruse)

for being awesome.


<script class="dontpublish" id="head" src="http://www.whatwg.org/specs/web-apps/current-work/dfn.js"></script>
