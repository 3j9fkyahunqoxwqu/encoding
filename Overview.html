<!DOCTYPE html><html lang="en-US"><meta charset="utf-8">
<title>Encoding Standard</title>
<style>
 pre.idl { border:solid thin; background:#eee; color:#000; padding:0.5em }
 pre.idl :link, pre.idl :visited { color:inherit; background:transparent }
 pre code { color:inherit; background:transparent }
 .example { margin-left:1em; padding-left:1em; border-left:double; color:#222; background:#fcfcfc }
 .note { margin-left:2em; font-weight:bold; font-style:italic; color:#008000 }
 p.note::before { content:"Note: " }
 .XXX { padding:.5em; border:solid #f00 }
 /*p.XXX::before { content:"Issue: " }*/
 dl.switch { padding-left:2em }
 dl.switch > dt { text-indent:-1.5em }
 dl.switch > dt:before { content:'\21AA'; padding:0 0.5em 0 0; display:inline-block; width:1em; text-align:right; line-height:0.5em }
 dl.domintro { color: green; margin: 2em 0 2em 2em; padding: 0.5em 1em; border: none; background: #DDFFDD; }
 dl.domintro dt, dl.domintro dt * { color: black; text-decoration: none; }
 dl.domintro dd { margin: 0.5em 0 1em 2em; padding: 0; }
 dl.domintro dd p { margin: 0.5em 0; }
 dl.domintro:before { display: table; margin: -1em -0.5em -0.5em auto; width: auto; content: 'This box is non-normative. Implementation requirements are given below this box.'; color: red; border: solid 2px; background: white; padding: 0 0.25em; }
 em.ct { text-transform:lowercase; font-variant:small-caps; font-style:normal }
 dfn { font-weight:bold; font-style:normal }
 code { color:orangered }
 code :link, code :visited { color:inherit }
 hr:not(.top) { display:block; background:none; border:none; padding:0; margin:2em 0; height:auto }
 table { border-collapse:collapse; border-style:hidden hidden none hidden }
 table thead { border-bottom:solid }
 table tbody th:first-child { border-left:solid }
 table td, table th { border-left:solid; border-right:solid; border-bottom:solid thin; vertical-align:top; padding:0.2em }
 .encoding th, .encoding td { font-family:monospace }

 .warning { color: red; background: transparent; font-weight: bolder; font-style: italic; }
 .warning p:first-child { margin-top: 0; }
 .warning p:last-child { margin-bottom: 0; }
 .warning:before { font-style: normal; }
 p.warning:before { content: '\26A0 Warning! '; }
</style>
<style>
 @media print { [data-anolis-spec]::after { content:"[" attr(data-anolis-spec) "]"; font-size:.6em; vertical-align:super; text-transform:uppercase } }
</style>
<link href="http://www.whatwg.org/style/specification" rel="stylesheet">

<div class="head">

<h1>Encoding</h1>
<h2 class="no-num no-toc" id="living-draft-—-4-march-2012">Living Draft — 4 March 2012</h2>

<dl>
 <dt>This Version:
 <dd><a href="http://dvcs.w3.org/hg/encoding/raw-file/tip/Overview.html">http://dvcs.w3.org/hg/encoding/raw-file/tip/Overview.html</a>

 <dt>Participate:</dt>
 <dd><a href="http://www.whatwg.org/mailing-list">whatwg@whatwg.org</a>
 <dd><a href="http://www.w3.org/Bugs/Public/enter_bug.cgi?product=Web%20Platform%20%28other%29&amp;component=Encoding">File a bug</a>
 <dd><a href="http://wiki.whatwg.org/wiki/IRC">IRC: #whatwg on Freenode</a>

 <dt>Editor:
 <dd class="vcard h-card">
  <a class="url u-url fn p-fn" href="http://annevankesteren.nl/" lang="nl">Anne van Kesteren</a>
  (<a class="org h-org" href="http://www.opera.com/">Opera Software ASA</a>)
  &lt;<a class="email u-email" href="mailto:annevk@opera.com">annevk@opera.com</a>&gt;
</dl>

<p class="copyright"><a href="http://creativecommons.org/publicdomain/zero/1.0/" rel="license"><img alt="CC0" src="http://i.creativecommons.org/p/zero/1.0/80x15.png"></a>
To the extent possible under law, the editors have waived all copyright and
related or neighboring rights to this work. In addition, as of
4 March 2012, the editors have made this specification available
under the
<a href="http://www.openwebfoundation.org/legal/the-owf-1-0-agreements/owfa-1-0" rel="license">Open Web Foundation Agreement Version 1.0</a>,
which is available at
http://www.openwebfoundation.org/legal/the-owf-1-0-agreements/owfa-1-0.

</div>

<hr class="top">


<h2 class="no-num no-toc" id="table-of-contents">Table of Contents</h2>


<!--begin-toc-->
<ol class="toc">
 <li><a href="#preface"><span class="secno">1 </span>Preface</a></li>
 <li><a href="#conformance"><span class="secno">2 </span>Conformance</a></li>
 <li><a href="#terminology"><span class="secno">3 </span>Terminology</a></li>
 <li><a href="#encodings"><span class="secno">4 </span>Encodings</a></li>
 <li><a href="#the-encoding"><span class="secno">5 </span>The encoding</a>
  <ol>
   <li><a href="#utf-8"><span class="secno">5.1 </span>utf-8</a></ol></li>
 <li><a href="#legacy-single-octet-encodings"><span class="secno">6 </span>Legacy single-octet encodings</a></li>
 <li><a href="#legacy-multi-octet-chinese-(simplified)-encodings"><span class="secno">7 </span>Legacy multi-octet Chinese (simplified) encodings</a>
  <ol>
   <li><a href="#gbk-and-gb18030"><span class="secno">7.1 </span>gbk and gb18030</a></li>
   <li><a href="#hz-gb-2312"><span class="secno">7.2 </span>hz-gb-2312</a></li>
   <li><a href="#iso-2022-cn"><span class="secno">7.3 </span>iso-2022-cn</a></ol></li>
 <li><a href="#legacy-multi-octet-chinese-(traditional)-encodings"><span class="secno">8 </span>Legacy multi-octet Chinese (traditional) encodings</a>
  <ol>
   <li><a href="#big5"><span class="secno">8.1 </span>big5</a></li>
   <li><a href="#big5-hkscs"><span class="secno">8.2 </span>big5-hkscs</a></ol></li>
 <li><a href="#legacy-multi-octet-japanese-encodings"><span class="secno">9 </span>Legacy multi-octet Japanese encodings</a>
  <ol>
   <li><a href="#euc-jp"><span class="secno">9.1 </span>euc-jp</a></li>
   <li><a href="#iso-2022-jp"><span class="secno">9.2 </span>iso-2022-jp</a></li>
   <li><a href="#shift_jis"><span class="secno">9.3 </span>shift_jis</a></ol></li>
 <li><a href="#legacy-multi-octet-korean-encodings"><span class="secno">10 </span>Legacy multi-octet Korean encodings</a>
  <ol>
   <li><a href="#euc-kr"><span class="secno">10.1 </span>euc-kr</a></li>
   <li><a href="#iso-2022-kr"><span class="secno">10.2 </span>iso-2022-kr</a></ol></li>
 <li><a href="#legacy-utf-16-encodings"><span class="secno">11 </span>Legacy utf-16 encodings</a>
  <ol>
   <li><a href="#utf-16"><span class="secno">11.1 </span>utf-16</a></li>
   <li><a href="#utf-16be"><span class="secno">11.2 </span>utf-16be</a></ol></li>
 <li><a class="no-num" href="#references">References</a></li>
 <li><a class="no-num" href="#acknowledgments">Acknowledgments</a></ol>
<!--end-toc-->


<h2 id="preface"><span class="secno">1 </span>Preface</h2>

<p>While encodings for the web platform have been defined to some extent,
implementations have not always implemented them in the same way, have not
always used the same labels, and often differ in dealing with undefined
areas of encodings. This standard attempts to fill those gaps so that new
implementations do not have to reverse engineer encoding implementations of
the market leaders.</p>


<h2 id="conformance"><span class="secno">2 </span>Conformance</h2>

<p>All diagrams, examples, and notes in this specification are
non-normative, as are all sections explicitly marked non-normative.
Everything else in this specification is normative.

<p>The key words "MUST", "MUST NOT", "REQUIRED", <!--"SHALL", "SHALL
NOT",--> "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and
"OPTIONAL" in the normative parts of this document are to be
interpreted as described in RFC2119. For readability, these words do
not appear in all uppercase letters in this specification.
<a data-anolis-ref="" href="#refsRFC2119">[RFC2119]</a>

<p>Conformance requirements phrased as algorithms or specific steps
may be implemented in any manner, so long as the end result is
equivalent. (In particular, the algorithms defined in this
specification are intended to be easy to follow, and not intended to
be performant.)

<p id="hardwareLimitations">User agents may impose
implementation-specific limits on otherwise unconstrained inputs,
e.g. to prevent denial of service attacks, to guard against running
out of memory, or to work around platform-specific limitations.


<h2 id="terminology"><span class="secno">3 </span>Terminology</h2>

<p>A <dfn id="code-point">code point</dfn> is a Unicode code point and is referenced as a
four-or-more digit hexadecimal value, typically preceded by "U+". E.g. U+0020.

<p>The <dfn id="fallback-code-point">fallback code point</dfn> is U+FFFD.

<p>An octet is referenced as a double-digit hexadecimal value, typically
preceded by "0x". E.g. 0xAA.

<p>The <dfn id="space-characters">space characters</dfn>, for the purposes of this specification,
are U+0020 SPACE, U+0009 CHARACTER TABULATION (tab), U+000A LINE FEED (LF),
U+000C FORM FEED (FF), and U+000D CARRIAGE RETURN (CR).

<p>Comparing two strings in an <dfn id="ascii-case-insensitive">ASCII case-insensitive</dfn> manner
means comparing them exactly, code point for code point, except that the
characters in the range U+0041 to U+005A (i.e. LATIN CAPITAL LETTER A to
LATIN CAPITAL LETTER Z) and the corresponding characters in the range
U+0061 to U+007A (i.e. LATIN SMALL LETTER A to LATIN SMALL LETTER Z) are
considered to also match.


<h2 id="encodings"><span class="secno">4 </span>Encodings</h2>

<p>An <dfn id="concept-encoding" title="concept-encoding">encoding</dfn> defines a mapping from a
code point to one or more octets (and vice versa). Each
<a href="#concept-encoding" title="concept-encoding">encoding</a> has a
<dfn id="concept-encoding-name" title="concept-encoding-name">name</dfn>, one or more
<dfn id="concept-encoding-label" title="concept-encoding-label">labels</dfn>, and potentially a
<dfn id="concept-encoding-map" title="concept-encoding-map">map</dfn>. A
<a href="#concept-encoding-map" title="concept-encoding-map">map</a> is a newline-separated (U+000A)
resource, where each line starts with one or more octets, followed by a
U+0009 code point, followed by a code point, followed by a U+0009
code point, followed by either the Unicode Character Name or
&lt;Private Use&gt;, which is preceded by a U+0023 code point.

<p>Each <a href="#concept-encoding" title="concept-encoding">encoding</a> also has a
<dfn id="decoder">decoder</dfn> and <dfn id="encoder">encoder</dfn> algorithm.

<p>A <a href="#decoder">decoder</a> algorithm takes a stream of octets and emits a
stream of code points. It has an associated
<dfn id="fatal-flag">fatal flag</dfn> that when set will make the algorithm return failure
if an invalid octet or octet sequence is in the stream. The
<dfn id="octet-pointer">octet pointer</dfn> is initially zero, pointing to the first octet in
the stream. It cannot be negative. It can be increased and decreased to
point to other octets in the stream. The <dfn id="eof-octet">EOF octet</dfn> is a
conceptual octet representing the last octet in a stream. The
<a href="#octet-pointer">octet pointer</a> cannot point beyond the <a href="#eof-octet">EOF octet</a>.
The <dfn id="eof-code-point">EOF code point</dfn> is a conceptual code point that is emitted
once the stream of octets is handled in its entirety. Apart from returning
failure, a <a href="#decoder">decoder</a> can end by emitting a code point, or the
word continue. Unless it returns failure, or the <a href="#eof-code-point">EOF code point</a>
is emitted, the <a href="#decoder">decoder</a> algorithm must be invoked again.

<p>An <a href="#encoder">encoder</a> algorithm takes a
stream of code points and emits a stream of octets. It will fail when
a code point is passed for which it does not have a corresponding octet or
octet sequence. Analogously to a <a href="#decoder">decoder</a>, it has a
<dfn id="code-point-pointer">code point pointer</dfn>. Again analogously, as long as the
<a href="#eof-octet">EOF octet</a> is not emitted, or failure is returned, the
<a href="#encoder">encoder</a> algorithm must be invoked for each octet emitted.

<p class="note">The <a href="#fatal-flag">fatal flag</a> is for XML, which
considers such an error a well-formed violation. Other formats such as HTML
will use <a href="#fallback-code-point" title="fallback code point">fallback code points</a> for
such errors and carry on.

<p class="note">Pre-processing is required to make an <a href="#encoder">encoder</a>
not fail (e.g. for HTML forms).

<hr>

<p>The table below lists all <a href="#concept-encoding" title="concept-encoding">encodings</a>
and their <a href="#concept-encoding-label" title="concept-encoding-label">labels</a> user agents must
support. User agents must not support any other
<a href="#concept-encoding" title="concept-encoding">encodings</a> or
<a href="#concept-encoding-label" title="concept-encoding-label">labels</a>.

<p>To <dfn id="concept-encoding-get" title="concept-encoding-get">get an encoding</dfn> from a string
<var title="">label</var>, run these steps:

<ol>
 <li><p>Remove any leading and trailing <a href="#space-characters">space characters</a> from
 <var title="">label</var>.

 <li><p>If <var title="">label</var> is an <a href="#ascii-case-insensitive">ASCII case-insensitive</a>
 match for any of the <a href="#concept-encoding-label" title="concept-encoding-label">labels</a>
 listed in the table below, return the corresponding
 <a href="#concept-encoding" title="concept-encoding">encoding</a> and terminate these steps.

 <li><p>Return failure.
</ol>

<p class="note">This algorithm is different from the one defined
in
<a href="http://www.unicode.org/reports/tr22/tr22-7.html#Charset_Alias_Matching">section 1.4 of Unicode Technical Standard #22</a>
as that algorithm is incompatible with legacy content.


<table>
 <thead>
  <tr>
   <th><a href="#concept-encoding-name" title="concept-encoding-name">Name</a>
   <th><a href="#concept-encoding-label" title="concept-encoding-label">Labels</a>
 <tbody>
 <tbody>
 <tbody>
  <tr><th colspan="2">The Encoding
  <tr>
   <td rowspan="3"><a href="#utf-8">utf-8</a>
   <td>"<code title="">unicode-1-1-utf-8</code>"
  <tr><td>"<code title="">utf-8</code>"
  <tr><td>"<code title="">utf8</code>"
 <tbody>
  <tr><th colspan="2">Legacy single-octet encodings
  <tr>
   <td rowspan="2"><a href="#ibm864">ibm864</a>
   <td>"<code title="">cp864</code>"
  <tr><td>"<code title="">ibm864</code>"
  <tr>
   <td rowspan="2"><a href="#ibm866">ibm866</a>
   <td>"<code title="">cp866</code>"
  <tr><td>"<code title="">ibm866</code>"
  <tr>
   <td rowspan="7"><a href="#iso-8859-2">iso-8859-2</a>
   <td>"<code title="">csisolatin2</code>"
  <tr><td>"<code title="">iso-8859-2</code>"
  <tr><td>"<code title="">iso-ir-101</code>"
  <tr><td>"<code title="">iso8859-2</code>"
  <tr><td>"<code title="">iso_8859-2</code>"
  <tr><td>"<code title="">l2</code>"
  <tr><td>"<code title="">latin2</code>"
  <tr>
   <td rowspan="6"><a href="#iso-8859-3">iso-8859-3</a>
   <td>"<code title="">csisolatin3</code>"
  <tr><td>"<code title="">iso-8859-3</code>"
  <tr><td>"<code title="">iso-ir-109</code>"
  <tr><td>"<code title="">iso_8859-3</code>"
  <tr><td>"<code title="">l3</code>"
  <tr><td>"<code title="">latin3</code>"
  <tr>
   <td rowspan="6"><a href="#iso-8859-4">iso-8859-4</a>
   <td>"<code title="">csisolatin4</code>"
  <tr><td>"<code title="">iso-8859-4</code>"
  <tr><td>"<code title="">iso-ir-110</code>"
  <tr><td>"<code title="">iso_8859-4</code>"
  <tr><td>"<code title="">l4</code>"
  <tr><td>"<code title="">latin4</code>"
  <tr>
   <td rowspan="5"><a href="#iso-8859-5">iso-8859-5</a>
   <td>"<code title="">csisolatincyrillic</code>"
  <tr><td>"<code title="">cyrillic</code>"
  <tr><td>"<code title="">iso-8859-5</code>"
  <tr><td>"<code title="">iso-ir-144</code>"
  <tr><td>"<code title="">iso_8859-5</code>"
  <tr>
   <td rowspan="6"><a href="#iso-8859-6">iso-8859-6</a>
   <td>"<code title="">arabic</code>"
  <tr><td>"<code title="">csisolatinarabic</code>"
  <tr><td>"<code title="">ecma-114</code>"
  <tr><td>"<code title="">iso-8859-6</code>"
  <tr><td>"<code title="">iso-ir-127</code>"
  <tr><td>"<code title="">iso_8859-6</code>"
  <tr>
   <td rowspan="8"><a href="#iso-8859-7">iso-8859-7</a>
   <td>"<code title="">csisolatingreek</code>"
  <tr><td>"<code title="">ecma-118</code>"
  <tr><td>"<code title="">elot_928</code>"
  <tr><td>"<code title="">greek</code>"
  <tr><td>"<code title="">greek8</code>"
  <tr><td>"<code title="">iso-8859-7</code>"
  <tr><td>"<code title="">iso-ir-126</code>"
  <tr><td>"<code title="">iso_8859-7</code>"
  <tr>
   <td rowspan="7"><a href="#iso-8859-8">iso-8859-8</a>
   <td>"<code title="">csisolatinhebrew</code>"
  <tr><td>"<code title="">hebrew</code>"
  <tr><td>"<code title="">iso-8859-8</code>"
  <tr><td>"<code title="">iso-8859-8-i</code>"
  <tr><td>"<code title="">iso-ir-138</code>"
  <tr><td>"<code title="">iso_8859-8</code>"
  <tr><td>"<code title="">visual</code>"
  <tr>
   <td rowspan="6"><a href="#iso-8859-10">iso-8859-10</a>
   <td>"<code title="">csisolatin6</code>"
  <tr><td>"<code title="">iso-8859-10</code>"
  <tr><td>"<code title="">iso-ir-157</code>"
  <tr><td>"<code title="">iso8859-10</code>"
  <tr><td>"<code title="">l6</code>"
  <tr><td>"<code title="">latin6</code>"
  <tr>
   <td><a href="#iso-8859-13">iso-8859-13</a>
   <td>"<code title="">iso-8859-13</code>"
  <tr>
   <td rowspan="2"><a href="#iso-8859-14">iso-8859-14</a>
   <td>"<code title="">iso-8859-14</code>"
  <tr><td>"<code title="">iso8859-14</code>"
  <tr>
   <td rowspan="2"><a href="#iso-8859-15">iso-8859-15</a>
   <td>"<code title="">iso-8859-15</code>"
  <tr><td>"<code title="">iso_8859-15</code>"
  <tr>
   <td><a href="#iso-8859-16">iso-8859-16</a>
   <td>"<code title="">iso-8859-16</code>"
  <tr>
   <td rowspan="2"><a href="#koi8-r">koi8-r</a>
   <td>"<code title="">koi8-r</code>"
  <tr><td>"<code title="">koi8_r</code>"
  <tr>
   <td><a href="#koi8-u">koi8-u</a>
   <td>"<code title="">koi8-u</code>"
  <tr>
   <td rowspan="4"><a href="#macintosh">macintosh</a>
   <td>"<code title="">csmacintosh</code>"
  <tr><td>"<code title="">mac</code>"
  <tr><td>"<code title="">macintosh</code>"
  <tr><td>"<code title="">x-mac-roman</code>"
  <tr>
   <td rowspan="3"><a href="#windows-874">windows-874</a>
   <td>"<code title="">iso-8859-11</code>"
  <tr><td>"<code title="">tis-620</code>"
  <tr><td>"<code title="">windows-874</code>"
  <tr>
   <td rowspan="2"><a href="#windows-1250">windows-1250</a>
   <td>"<code title="">windows-1250</code>"
  <tr><td>"<code title="">x-cp1250</code>"
  <tr>
   <td rowspan="2"><a href="#windows-1251">windows-1251</a>
   <td>"<code title="">windows-1251</code>"
  <tr><td>"<code title="">x-cp1251</code>"
  <tr>
   <td rowspan="10"><a href="#windows-1252">windows-1252</a>
   <td>"<code title="">ansi_x3.4-1968</code>"
  <tr><td>"<code title="">ascii</code>"
  <tr><td>"<code title="">csisolatin1</code>"
  <tr><td>"<code title="">iso-8859-1</code>"
  <tr><td>"<code title="">iso8859-1</code>"
  <tr><td>"<code title="">iso_8859-1</code>"
  <tr><td>"<code title="">l1</code>"
  <tr><td>"<code title="">latin1</code>"
  <tr><td>"<code title="">us-ascii</code>"
  <tr><td>"<code title="">windows-1252</code>"
  <tr>
   <td rowspan="2"><a href="#windows-1253">windows-1253</a>
   <td>"<code title="">cp1253</code>"
  <tr><td>"<code title="">windows-1253</code>"
  <tr>
   <td rowspan="6"><a href="#windows-1254">windows-1254</a>
   <td>"<code title="">csisolatin5</code>"
  <tr><td>"<code title="">iso-8859-9</code>"
  <tr><td>"<code title="">iso-ir-148</code>"
  <tr><td>"<code title="">l5</code>"
  <tr><td>"<code title="">latin5</code>"
  <tr><td>"<code title="">windows-1254</code>"
  <tr>
   <td rowspan="2"><a href="#windows-1255">windows-1255</a>
   <td>"<code title="">cp1255</code>"
  <tr><td>"<code title="">windows-1255</code>"
  <tr>
   <td rowspan="2"><a href="#windows-1256">windows-1256</a>
   <td>"<code title="">cp1256</code>"
  <tr><td>"<code title="">windows-1256</code>"
  <tr>
   <td><a href="#windows-1257">windows-1257</a>
   <td>"<code title="">windows-1257</code>"
  <tr>
   <td rowspan="2"><a href="#windows-1258">windows-1258</a>
   <td>"<code title="">cp1258</code>"
  <tr><td>"<code title="">windows-1258</code>"
  <tr>
   <td rowspan="2"><a href="#x-mac-cyrillic">x-mac-cyrillic</a>
   <td>"<code title="">x-mac-cyrillic</code>"
  <tr><td>"<code title="">x-mac-ukrainian</code>"
 <tbody>
  <tr><th colspan="2">Legacy multi-octet Chinese (simplified) encodings
  <tr>
   <td rowspan="9"><a href="#gbk-and-gb18030">gbk</a>
   <td>"<code title="">chinese</code>"
  <tr><td>"<code title="">csgb2312</code>"
  <tr><td>"<code title="">csiso58gb231280</code>"
  <tr><td>"<code title="">gb2312</code>"
  <tr><td>"<code title="">gb_2312</code>"
  <tr><td>"<code title="">gb_2312-80</code>"
  <tr><td>"<code title="">gbk</code>"
  <tr><td>"<code title="">iso-ir-58</code>"
  <tr><td>"<code title="">x-gbk</code>"
  <tr>
   <td><a href="#hz-gb-2312">hz-gb-2312</a>
   <td>"<code title="">hz-gb-2312</code>"
  <tr>
   <td><a href="#gbk-and-gb18030">gb18030</a>
   <td>"<code title="">gb18030</code>"
  <tr>
   <td rowspan="2"><a href="#iso-2022-cn">iso-2022-cn</a>
   <td>"<code title="">iso-2022-cn</code>"
  <tr><td>"<code title="">iso-2022-cn-ext</code>"
 <tbody>
  <tr><th colspan="2">Legacy multi-octet Chinese (traditional) encodings
  <tr>
   <td rowspan="4"><a href="#big5">big5</a>
   <td>"<code title="">big5</code>"
  <tr><td>"<code title="">cn-big5</code>"
  <tr><td>"<code title="">csbig5</code>"
  <tr><td>"<code title="">x-x-big5</code>"
  <tr>
   <td><a href="#big5-hkscs">big5-hkscs</a>
   <td>"<code title="">big5-hkscs</code>"
 <tbody>
  <tr><th colspan="2">Legacy multi-octet Japanese encodings
  <tr>
   <td rowspan="3"><a href="#euc-jp">euc-jp</a>
   <td>"<code title="">cseucjpkdfmtjapanese</code>"
  <tr><td>"<code title="">euc-jp</code>"
  <tr><td>"<code title="">x-euc-jp</code>"
  <tr>
   <td rowspan="2"><a href="#iso-2022-jp">iso-2022-jp</a>
   <td>"<code title="">csiso2022jp</code>"
  <tr><td>"<code title="">iso-2022-jp</code>"
  <tr>
   <td rowspan="6"><a href="#shift_jis">shift_jis</a>
   <td>"<code title="">csshiftjis</code>"
  <tr><td>"<code title="">ms_kanji</code>"
  <tr><td>"<code title="">shift-jis</code>"
  <tr><td>"<code title="">shift_jis</code>"
  <tr><td>"<code title="">windows-31j</code>"
  <tr><td>"<code title="">x-sjis</code>"
 <tbody>
  <tr><th colspan="2">Legacy multi-octet Korean encodings
  <tr>
   <td rowspan="9"><a href="#euc-kr">euc-kr</a>
   <td>"<code title="">csksc56011987</code>"
  <tr><td>"<code title="">csueckr</code>"
  <tr><td>"<code title="">euc-kr</code>"
  <tr><td>"<code title="">iso-ir-149</code>"
  <tr><td>"<code title="">korean</code>"
  <tr><td>"<code title="">ks_c_5601-1989</code>"
  <tr><td>"<code title="">ksc5601</code>"
  <tr><td>"<code title="">ksc_5601</code>"
  <tr><td>"<code title="">windows-949</code>"
  <tr>
   <td rowspan="2"><a href="#iso-2022-kr">iso-2022-kr</a>
   <td>"<code title="">csiso2022kr</code>"
  <tr><td>"<code title="">iso-2022-kr</code>"
 <tbody>
  <tr><th colspan="2">Legacy utf-16 encodings
  <tr>
   <td rowspan="2"><a href="#utf-16">utf-16</a>
   <td>"<code title="">utf-16</code>"
  <tr><td>"<code title="">utf-16le</code>"
  <tr>
   <td><a href="#utf-16be">utf-16be</a>
   <td>"<code title="">utf-16be</code>"
</table>


<h2 id="the-encoding"><span class="secno">5 </span>The encoding</h2>

<p>New content and formats must exclusively use the <a href="#utf-8">utf-8</a>
<a href="#concept-encoding" title="concept-encoding">encoding</a>.


<h3 id="utf-8"><span class="secno">5.1 </span><dfn>utf-8</dfn></h3>

<!--
http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#utf-8
Unicode
-->

<p>The <dfn id="utf-8-code-point">utf-8 code point</dfn>, <dfn id="utf-8-octets-seen">utf-8 octets seen</dfn>,
<dfn id="utf-8-octets-needed">utf-8 octets needed</dfn>, and <dfn id="utf-8-lower-boundary">utf-8 lower boundary</dfn> concepts
are all initially 0.

<p>The <dfn id="utf-8-decoder">utf-8 decoder</dfn> (<a href="#decoder">decoder</a> for <a href="#utf-8">utf-8</a>) is:

<ol>
 <li><p>Let <var title="">octet</var> be <a href="#octet-pointer">octet pointer</a>.

 <li><p>If <var title="">octet</var> is the <a href="#eof-octet">EOF octet</a>,
 <a href="#utf-8-octets-needed">utf-8 octets needed</a> is not 0, and the <a href="#fatal-flag">fatal flag</a>
 is set, return failure.

 <li><p>If <var title="">octet</var> is the <a href="#eof-octet">EOF octet</a> and
 <a href="#utf-8-octets-needed">utf-8 octets needed</a> is not 0, emit the
 <a href="#fallback-code-point">fallback code point</a>, followed by the
 <a href="#eof-code-point">EOF code point</a>.

 <li><p>If <var title="">octet</var> is the <a href="#eof-octet">EOF octet</a>, emit the
 <a href="#eof-code-point">EOF code point</a>.

 <li><p>Increase the <a href="#octet-pointer">octet pointer</a>.

 <li>
  <p>If <a href="#utf-8-octets-needed">utf-8 octets needed</a> is 0, based on
  <var title="">octet</var>:

  <dl class="switch">
   <dt>0x00 to 0x7F
   <dd><p>Emit <var title="">octet</var> as code point.

   <dt>0xC0 to 0xDF
   <dd><p>Set <a href="#utf-8-octets-needed">utf-8 octets needed</a> to 1,
   <a href="#utf-8-lower-boundary">utf-8 lower boundary</a> to 0x80, and
   <a href="#utf-8-code-point">utf-8 code point</a> to <var title="">octet</var> − 0xC0

   <dt>0xE0 to 0xEF
   <dd><p>Set <a href="#utf-8-octets-needed">utf-8 octets needed</a> to 2,
   <a href="#utf-8-lower-boundary">utf-8 lower boundary</a> to 0x800, and
   <a href="#utf-8-code-point">utf-8 code point</a> to <var title="">octet</var> − 0xE0

   <dt>0xF0 to 0xF7
   <dd><p>Set <a href="#utf-8-octets-needed">utf-8 octets needed</a> to 3,
   <a href="#utf-8-lower-boundary">utf-8 lower boundary</a> to 0x10000, and
   <a href="#utf-8-code-point">utf-8 code point</a> to <var title="">octet</var> − 0xF0

   <dt>0xF8 to 0xFB
   <dd><p>Set <a href="#utf-8-octets-needed">utf-8 octets needed</a> to 4,
   <a href="#utf-8-lower-boundary">utf-8 lower boundary</a> to 0x200000, and
   <a href="#utf-8-code-point">utf-8 code point</a> to <var title="">octet</var> − 0xF8

   <dt>0xFC to 0xFD
   <dd><p>Set <a href="#utf-8-octets-needed">utf-8 octets needed</a> to 5,
   <a href="#utf-8-lower-boundary">utf-8 lower boundary</a> to 0x4000000, and
   <a href="#utf-8-code-point">utf-8 code point</a> to <var title="">octet</var> − 0xFC

   <dt>Otherwise
   <dd><p>Emit the <a href="#fallback-code-point">fallback code point</a>.
  </dl>

  <p>Then (<var title="">octet</var> was in the range 0xC0 to 0xFD) set
  <a href="#utf-8-code-point">utf-8 code point</a> to <a href="#utf-8-code-point">utf-8 code point</a> ×
  64<sup><a href="#utf-8-octets-needed">utf-8 octets needed</a></sup> and continue.

 <li>
  <p>If <var title="">octet</var> is not in the range 0x80 to 0xBF, run these
  substeps:

  <ol>
   <li><p>If the <a href="#fatal-flag">fatal flag</a> is set, return failure.

   <li><p>Set <a href="#utf-8-code-point">utf-8 code point</a>,
   <a href="#utf-8-octets-needed">utf-8 octets needed</a>, <a href="#utf-8-octets-seen">utf-8 octets seen</a>, and
   <a href="#utf-8-lower-boundary">utf-8 lower boundary</a> to 0.

   <li><p>Decrease the <a href="#octet-pointer">octet pointer</a> by one.

   <li><p>Emit the <a href="#fallback-code-point">fallback code point</a>.
  </ol>

 <li>
  <p>Increase <a href="#utf-8-octets-seen">utf-8 octets seen</a> by one and set
  <a href="#utf-8-code-point">utf-8 code point</a> to
  <a href="#utf-8-code-point">utf-8 code point</a> + (<var title="">octet</var> - 0x80) ×
  64<sup><a href="#utf-8-octets-needed">utf-8 octets needed</a> − <a href="#utf-8-octets-seen">utf-8 octets seen</a></sup>

 <li><p>If <a href="#utf-8-octets-seen">utf-8 octets seen</a> is not equal to
 <a href="#utf-8-octets-needed">utf-8 octets needed</a>, continue.

 <li><p>Let <var title="">code point</var> be <a href="#utf-8-code-point">utf-8 code point</a> and
 <var title="">lower boundary</var> be <a href="#utf-8-lower-boundary">utf-8 lower boundary</a>

 <li><p>Set <a href="#utf-8-code-point">utf-8 code point</a>,
 <a href="#utf-8-octets-needed">utf-8 octets needed</a>, <a href="#utf-8-octets-seen">utf-8 octets seen</a>, and
 <a href="#utf-8-lower-boundary">utf-8 lower boundary</a> to 0.

 <li><p>If <var title="">code point</var> is equal or greater than
 <var title="">lower boundary</var>, equal or smaller than 0x10FFFF, and is not
 in the range 0xD800 to 0xDFFF, emit <var title="">code point</var>.

 <li><p>If the <a href="#fatal-flag">fatal flag</a> is set, return failure.

 <li><p>Emit the <a href="#fallback-code-point">fallback code point</a>.
</ol>


<p>The <dfn id="utf-8-encoder">utf-8 encoder</dfn> (<a href="#encoder">encoder</a> for <a href="#utf-8">utf-8</a>) is:

<ol class="XXX"></ol>


<h2 id="legacy-single-octet-encodings"><span class="secno">6 </span>Legacy single-octet encodings</h2>

<p>An <a href="#concept-encoding" title="concept-encoding">encoding</a> where each octet is
either a single code point or nothing, is a
<dfn id="single-octet-encoding">single-octet encoding</dfn>. These are the
<a href="#single-octet-encoding" title="single-octet encoding">single-octet encodings</a> and their
corresponding <a href="#concept-encoding-map" title="concept-encoding-map">map</a>:

<table>
 <tr><th><a href="#concept-encoding-name" title="concept-encoding-name">Name</a><th><a href="#concept-encoding-map" title="concept-encoding-map">Map</a>
 <tr><td><dfn id="ibm864">ibm864</dfn><td><a href="map-ibm864.txt">map-ibm864.txt</a>
 <tr><td><dfn id="ibm866">ibm866</dfn><td><a href="map-ibm866.txt">map-ibm866.txt</a>
 <tr><td><dfn id="iso-8859-2">iso-8859-2</dfn><td><a href="map-iso-8859-2.txt">map-iso-8859-2.txt</a>
 <tr><td><dfn id="iso-8859-3">iso-8859-3</dfn><td><a href="map-iso-8859-3.txt">map-iso-8859-3.txt</a>
 <tr><td><dfn id="iso-8859-4">iso-8859-4</dfn><td><a href="map-iso-8859-4.txt">map-iso-8859-4.txt</a>
 <tr><td><dfn id="iso-8859-5">iso-8859-5</dfn><td><a href="map-iso-8859-5.txt">map-iso-8859-5.txt</a>
 <tr><td><dfn id="iso-8859-6">iso-8859-6</dfn><td><a href="map-iso-8859-6.txt">map-iso-8859-6.txt</a>
 <tr><td><dfn id="iso-8859-7">iso-8859-7</dfn><td><a href="map-iso-8859-7.txt">map-iso-8859-7.txt</a>
 <tr><td><dfn id="iso-8859-8">iso-8859-8</dfn><td><a href="map-iso-8859-8.txt">map-iso-8859-8.txt</a>
 <tr><td><dfn id="iso-8859-10">iso-8859-10</dfn><td><a href="map-iso-8859-10.txt">map-iso-8859-10.txt</a>
 <tr><td><dfn id="iso-8859-13">iso-8859-13</dfn><td><a href="map-iso-8859-13.txt">map-iso-8859-13.txt</a>
 <tr><td><dfn id="iso-8859-14">iso-8859-14</dfn><td><a href="map-iso-8859-14.txt">map-iso-8859-14.txt</a>
 <tr><td><dfn id="iso-8859-15">iso-8859-15</dfn><td><a href="map-iso-8859-15.txt">map-iso-8859-15.txt</a>
 <tr><td><dfn id="iso-8859-16">iso-8859-16</dfn><td><a href="map-iso-8859-16.txt">map-iso-8859-16.txt</a>
 <tr><td><dfn id="koi8-r">koi8-r</dfn><td><a href="map-koi8-r.txt">map-koi8-r.txt</a>
 <tr><td><dfn id="koi8-u">koi8-u</dfn><td><a href="map-koi8-u.txt">map-koi8-u.txt</a>
 <tr><td><dfn id="macintosh">macintosh</dfn><td><a href="map-macintosh.txt">map-macintosh.txt</a>
 <tr><td><dfn id="windows-874">windows-874</dfn><td><a href="map-windows-874.txt">map-windows-874.txt</a>
 <tr><td><dfn id="windows-1250">windows-1250</dfn><td><a href="map-windows-1250.txt">map-windows-1250.txt</a>
 <tr><td><dfn id="windows-1251">windows-1251</dfn><td><a href="map-windows-1251.txt">map-windows-1251.txt</a>
 <tr><td><dfn id="windows-1252">windows-1252</dfn><td><a href="map-windows-1252.txt">map-windows-1252.txt</a>
 <tr><td><dfn id="windows-1253">windows-1253</dfn><td><a href="map-windows-1253.txt">map-windows-1253.txt</a>
 <tr><td><dfn id="windows-1254">windows-1254</dfn><td><a href="map-windows-1254.txt">map-windows-1254.txt</a>
 <tr><td><dfn id="windows-1255">windows-1255</dfn><td><a href="map-windows-1255.txt">map-windows-1255.txt</a>
 <tr><td><dfn id="windows-1256">windows-1256</dfn><td><a href="map-windows-1256.txt">map-windows-1256.txt</a>
 <tr><td><dfn id="windows-1257">windows-1257</dfn><td><a href="map-windows-1257.txt">map-windows-1257.txt</a>
 <tr><td><dfn id="windows-1258">windows-1258</dfn><td><a href="map-windows-1258.txt">map-windows-1258.txt</a>
 <tr><td><dfn id="x-mac-cyrillic">x-mac-cyrillic</dfn><td><a href="map-x-mac-cyrillic.txt">map-x-mac-cyrillic.txt</a>
</table>

<hr>

<p>The <dfn id="single-octet-decoder">single-octet decoder</dfn> (<a href="#decoder">decoder</a> for
<a href="#single-octet-encoding" title="single-octet encoding">single-octet encodings</a>) is:

<ol>
 <li><p>Let <var title="">octet</var> be <a href="#octet-pointer">octet pointer</a>.

 <li><p>If <var title="">octet</var> is the <a href="#eof-octet">EOF octet</a>, emit the
 <a href="#eof-code-point">EOF code point</a>.

 <li><p>Increase the <a href="#octet-pointer">octet pointer</a> by one.

 <li><p>If <var title="">octet</var> is in the range 0x00 to 0x7F, emit a code
 point whose value is <var title="">octet</var>.

 <li><p>If <var title="">octet</var> is not in the
 <a href="#concept-encoding-map" title="concept-encoding-map">map</a> and the <a href="#fatal-flag">fatal flag</a>
 is set, return failure.

 <li><p>If <var title="">octet</var> is not in the
 <a href="#concept-encoding-map" title="concept-encoding-map">map</a>, emit the
 <a href="#fallback-code-point">fallback code point</a>.

 <li><p>Emit the code point given in the
 <a href="#concept-encoding-map" title="concept-encoding-map">map</a> for <var title="">octet</var>.
</ol>

<p>The <dfn id="single-octet-encoder">single-octet encoder</dfn> (<a href="#encoder">encoder</a> for
<a href="#single-octet-encoding" title="single-octet encoding">single-octet encodings</a>) is:

<ol>
 <li><p>Let <var title="">code point</var> be <a href="#code-point-pointer">code point pointer</a>.

 <li><p>If <var title="">code point</var> is the <a href="#eof-code-point">EOF code point</a>,
 emit the <a href="#eof-octet">EOF octet</a>.

 <li><p>Increase the <a href="#code-point-pointer">code point pointer</a> by one.

 <li><p>If <var title="">code point</var> is in the range U+0000 to U+007F,
 emit an octet whose value is <var title="">code point</var>.

 <li><p>If <var title="">code point</var> is not listed in the
 <a href="#concept-encoding-map" title="concept-encoding-map">map</a>, return failure.

 <li><p>Emit the octet given in the
 <a href="#concept-encoding-map" title="concept-encoding-map">map</a> for
 <var title="">code point</var>.
</ol>

<hr>

<p class="note">See also:
<a href="single-octet-research.html">single-octet research</a>.

<p class="note"><a href="#single-octet-encoding">Single-octet encoding</a> map data is also available as a
non-normative JSON resource: <a href="single-octet-encodings.json"><code>single-octet-encodings.json</code></a>.


<h2 id="legacy-multi-octet-chinese-(simplified)-encodings"><span class="secno">7 </span>Legacy multi-octet Chinese (simplified) encodings</h2>

<p>The <dfn id="gbk-code-point">gbk code point</dfn> for a given number is: ...


<h3 id="gbk-and-gb18030"><span class="secno">7.1 </span><dfn>gbk</dfn> and <dfn>gb18030</dfn></h3>

<p>The <dfn id="gb18030-flag">gb18030 flag</dfn> flag is initially unset. It must be set if
the <a href="#gbk-and-gb18030">gb18030</a> encoding is in use.

<p>The <dfn id="gbk-first">gbk first</dfn>, <dfn id="gbk-second">gbk second</dfn>, and
<dfn id="gbk-third">gbk third</dfn>, are all initially 0x00.

<p class="XXX">...


<h3 id="hz-gb-2312"><span class="secno">7.2 </span><dfn>hz-gb-2312</dfn></h3>
<!--
 http://tools.ietf.org/html/rfc1842
 http://tools.ietf.org/html/rfc1843
-->

<p>The <dfn id="hz-gb-2312-flag">hz-gb-2312 flag</dfn> is initially unset. The
<dfn id="hz-gb-2312-lead">hz-gb-2312 lead</dfn> is initially 0x00.</p>

<p>The <dfn id="hz-gb-2312-decoder">hz-gb-2312 decoder</dfn> (<a href="#decoder">decoder</a> for <a href="#hz-gb-2312">hz-gb-2312</a>) is:

<ol>
 <li><p>Let <var title="">octet</var> be <a href="#octet-pointer">octet pointer</a>.

 <li><p>If <var title="">octet</var> is the <a href="#eof-octet">EOF octet</a> and
 <a href="#hz-gb-2312-lead">hz-gb-2312 lead</a> is 0x00, emit the
 <a href="#eof-code-point">EOF code point</a>.

 <li><p>If <var title="">octet</var> is the <a href="#eof-octet">EOF octet</a>,
 <a href="#hz-gb-2312-lead">hz-gb-2312 lead</a> is not 0x00, and the <a href="#fatal-flag">fatal flag</a>
 is set, return failure.

 <li><p>If <var title="">octet</var> is the <a href="#eof-octet">EOF octet</a> and
 <a href="#hz-gb-2312-lead">hz-gb-2312 lead</a> is not 0x00, set <a href="#hz-gb-2312-lead">hz-gb-2312 lead</a>
 to 0x00 and emit the <a href="#fallback-code-point">fallback code point</a>.

 <li><p>Increase the <a href="#octet-pointer">octet pointer</a>.

 <li>
  <p>If <a href="#hz-gb-2312-lead">hz-gb-2312 lead</a> is 0x7E, set
  <a href="#hz-gb-2312-lead">hz-gb-2312 lead</a> to 0x00, and based on <var title="">octet</var>:

  <dl class="switch">
   <dt>0x7B<!--{-->
   <dd>Set the <a href="#hz-gb-2312-flag">hz-gb-2312 flag</a> and continue.

   <dt>0x7D<!--}-->
   <dd>Unset the <a href="#hz-gb-2312-flag">hz-gb-2312 flag</a> and continue.
   <!--In "ASCII mode" IE outputs ~}, Gecko outputs U+FFFD, Chrome outputs
   a single U+FFFD for ~}~}. Weird. Opera just skips.-->

   <dt>0x7E<!--~-->
   <dd>Emit a U+007E code point.

   <dt>0x0A<!--newline-->
   <dd>Set <a href="#hz-gb-2312-lead">hz-gb-2312 lead</a> to 0x00 and continue.

   <dt>Otherwise
   <dd>
    <p>If the <a href="#fatal-flag">fatal flag</a> is set, return failure.

    <p>Otherwise, decrease the <a href="#octet-pointer">octet pointer</a> by one and emit
    the <a href="#fallback-code-point">fallback code point</a>.
  </dl>

 <li>
  <p>If <a href="#hz-gb-2312-lead">hz-gb-2312 lead</a> is not 0x00, set
  <a href="#hz-gb-2312-lead">hz-gb-2312 lead</a> to 0x00 and:

  <ol>
   <li><p class="XXX">Let <var title="">code point</var> be
   <a href="#gbk-code-point">gbk code point</a> for ...
   <!-- (hz-gb-2312 lead - 1) * 191 + (octet + 0x40) -->

   <li><p>If <var title="">octet</var> is in the range 0x20 to 0x7F and
   <var title="">code point</var> is not null, emit
   <var title="">code point</var>.

   <li><p>If the <a href="#fatal-flag">fatal flag</a> is set, return failure.

   <li><p>If <var title="">octet</var> is 0x0A, unset the
   <a href="#hz-gb-2312-flag">hz-gb-2312 flag</a>.

   <li><p>Emit the <a href="#fallback-code-point">fallback code point</a>.
  </ol>

 <li><p>If <var title="">octet</var> is 0x7E<!--~-->, set
 <a href="#hz-gb-2312-lead">hz-gb-2312 lead</a> to 0x7E and continue.

 <li>
  <p>If the <a href="#hz-gb-2312-flag">hz-gb-2312 flag</a> is set:

  <ol>
   <li><p>If <var title="">octet</var> is in the range 0x20 to 0x7F, set
   <a href="#hz-gb-2312-lead">hz-gb-2312 lead</a> to <var title="">octet</var> and continue.

   <li><p>If the <a href="#fatal-flag">fatal flag</a> is set, return failure.

   <li><p>If <var title="">octet</var> is 0x0A, unset the
   <a href="#hz-gb-2312-flag">hz-gb-2312 flag</a>.

   <li><p>Emit the <a href="#fallback-code-point">fallback code point</a>.
  </ol>

 <li><p>If <var title="">octet</var> is in the range 0x00 to 0x7F, emit a
 code point whose value is <var title="">octet</var>.

 <li><p>If the <a href="#fatal-flag">fatal flag</a> is set, return failure.

 <li><p>Emit the <a href="#fallback-code-point">fallback code point</a>.
</ol>

<p>The <dfn id="hz-gb-2312-encoder">hz-gb-2312 encoder</dfn> (<a href="#encoder">encoder</a> for <a href="#hz-gb-2312">hz-gb-2312</a>) is:

<ol class="XXX"></ol>


<h3 id="iso-2022-cn"><span class="secno">7.3 </span><dfn>iso-2022-cn</dfn></h3>
<!-- http://tools.ietf.org/html/rfc1922 -->

<p class="XXX">...


<h2 id="legacy-multi-octet-chinese-(traditional)-encodings"><span class="secno">8 </span>Legacy multi-octet Chinese (traditional) encodings</h2>


<h3 id="big5"><span class="secno">8.1 </span><dfn>big5</dfn></h3><!-- cp950 -->

<p class="XXX">The <dfn id="big5-code-point">big5 code point</dfn> for two octets
(<var title="">octet<sub>1</sub></var>, <var title="">octet<sub>2</sub></var>) is
...

<p class="XXX">Include Gecko extensions? https://bugzilla.mozilla.org/show_bug.cgi?id=310299

<p>The <dfn id="big5-lead">big5 lead</dfn> is initially 0x00.

<p>The <dfn id="big5-decoder">big5 decoder</dfn> (<a href="#decoder">decoder</a> for <a href="#big5">big5</a>) is:
<!-- identical to euc-kr -->

<ol>
 <li><p>Let <var title="">octet</var> be <a href="#octet-pointer">octet pointer</a>.

 <li><p>If <var title="">octet</var> is the <a href="#eof-octet">EOF octet</a> and
 <a href="#big5-lead">big5 lead</a> is 0x00, emit the
 <a href="#eof-code-point">EOF code point</a>.

 <li><p>If <var title="">octet</var> is the <a href="#eof-octet">EOF octet</a>,
 <a href="#big5-lead">big5 lead</a> is not 0x00, and the <a href="#fatal-flag">fatal flag</a> is
 set, return failure.

 <li><p>If <var title="">octet</var> is the <a href="#eof-octet">EOF octet</a>,
 <a href="#big5-lead">big5 lead</a> is not 0x00, emit the
 <a href="#fallback-code-point">fallback code point</a>.

 <li><p>Increase the <a href="#octet-pointer">octet pointer</a> by one.

 <li><p>If <a href="#big5-lead">big5 lead</a> is 0x00 and <var title="">octet</var> is
 in the range 0x00 to 0x7F, emit a code point whose value is
 <var title="">octet</var>.

 <li><p>If <a href="#big5-lead">big5 lead</a> is 0x00, set <a href="#big5-lead">big5 lead</a>
 to <var title="">octet</var> and continue.

 <li><p>Let <var title="">code point</var> be the
 <a href="#big5-code-point">big5 code point</a> for
 (<a href="#big5-lead">big5 lead</a>, <var title="">octet</var>).

 <li><p>Set <a href="#big5-lead">big5 lead</a> to 0x00.

 <li><p>If <var title="">code point</var> is not null, emit
 <var title="">code point</var>.

 <li><p>If the <a href="#fatal-flag">fatal flag</a> is set, return failure.

 <li><p>If <var title="">octet</var> is in the range 0x00 0x7F, decrease the
 <a href="#octet-pointer">octet pointer</a> by one.

 <li><p>Emit the <a href="#fallback-code-point">fallback code point</a>.
</ol>

<p>The <dfn id="big5-encoder">big5 encoder</dfn> (<a href="#encoder">encoder</a> for <a href="#big5">big5</a>) is:

<ol class="XXX"></ol>


<h3 id="big5-hkscs"><span class="secno">8.2 </span><dfn>big5-hkscs</dfn></h3>

<p class="XXX">Not supported by IE, supported by everyone else.
https://bugzilla.mozilla.org/show_bug.cgi?id=310299#c5
http://www.google.com/support/forum/p/Chrome/thread?tid=466c210af3fb6d08
http://w3techs.com/technologies/details/en-b5hkscs/all/all


<h2 id="legacy-multi-octet-japanese-encodings"><span class="secno">9 </span>Legacy multi-octet Japanese encodings</h2>

<p class="XXX">The <dfn id="jis-code-point">jis code point</dfn> for a given number is: ...</p>

<p>The <dfn id="jis0208-index">jis0208 index</dfn> for a given <var title="">octet</var> is:
<!-- only valid in range A1-FE -->

<dl class="switch">
 <dt>0xA1 to 0xA2
 <dd><!--8648-->(<var title="">octet</var> − 0x45) × 94

 <dt>0xA3 to 0xA8
 <dd><!--376-->(<var title="">octet</var> − 0x9F) × 94

 <dt>0xAD
 <dd>940

 <dt>0xB1 to 0xF4
 <dd><!--1222-->(<var title="">octet</var> − 0xA4) × 94

 <dt>0xF9 to 0xFC
 <dd><!--7708-->(<var title="">octet</var> − 0xA7) × 94

 <dt>Otherwise
 <dd>null
</dl>

<p>The <dfn id="jis0212-index">jis0212 index</dfn> for a given <var title="">octet</var> is:
<!-- only valid in range A1-FE -->

<dl class="switch">
 <dt>0xA2
 <dd>9400
 <dt>0xA6 to 0xA7
 <dd><!--9494-->(<var title="">octet</var> − 0x41) × 94
 <dt>0xA9 to 0xAB
 <dd><!--9682-->(<var title="">octet</var> − 0x42) × 94
 <dt>0xB0 to 0xED
 <dd><!--9964-->(<var title="">octet</var> − 0x46) × 94
 <dt>Otherwise
 <dd>null
</dl>


<h3 id="euc-jp"><span class="secno">9.1 </span><dfn>euc-jp</dfn></h3>

<p>The <dfn id="euc-jp-offset">euc-jp offset</dfn> for a given <var title="">octet</var> is null
if <var title="">octet</var> − 0xA1 is greater than 93 or less than 0, or
otherwise the result of that equation.

<p>The <dfn id="euc-jp-first">euc-jp first</dfn> and <dfn id="euc-jp-second">euc-jp second</dfn> are 0x00.

<p>The <dfn id="euc-jp-decoder">euc-jp decoder</dfn> (<a href="#decoder">decoder</a> for <a href="#euc-jp">euc-jp</a>) is:

<ol>
 <li><p>Let <var title="">octet</var> be <a href="#octet-pointer">octet pointer</a>.

 <li><p>If <var title="">octet</var> is the <a href="#eof-octet">EOF octet</a> and
 <a href="#euc-jp-first">euc-jp first</a> and <a href="#euc-jp-second">euc-jp second</a> are 0x00, emit the
 <a href="#eof-code-point">EOF code point</a>.

 <li><p>If <var title="">octet</var> is either the <a href="#eof-octet">EOF octet</a> or is
 in the range 0x00 to 0x7F, either <a href="#euc-jp-first">euc-jp first</a> or
 <a href="#euc-jp-second">euc-jp second</a> is not 0x00, and the <a href="#fatal-flag">fatal flag</a> is
 set, return failure.

 <li><p>If <var title="">octet</var> is either the <a href="#eof-octet">EOF octet</a> or is
 in the range 0x00 to 07F, and <a href="#euc-jp-second">euc-jp second</a> is 0x00,
 set <a href="#euc-jp-first">euc-jp first</a> to 0x00 and emit the
 <a href="#fallback-code-point">fallback code point</a>.

 <li><p>If <var title="">octet</var> is either the <a href="#eof-octet">EOF octet</a> or is
 in the range 0x00 to 0x7F, and <a href="#euc-jp-second">euc-jp second</a> is not 0x00, set
 <a href="#euc-jp-first">euc-jp first</a> and <a href="#euc-jp-second">euc-jp second</a> to 0x00, decrease
 the <a href="#octet-pointer">octet pointer</a> by one, and emit the
 <a href="#fallback-code-point">fallback code point</a>.

 <li><p>Increase the <a href="#octet-pointer">octet pointer</a> by one.

 <li>
  <p>If <a href="#euc-jp-second">euc-jp second</a> is not 0x00, run these substeps:
  <!--euc-jp first must be 0x8E-->

  <ol>
   <li><p>Let <var title="">lead</var> be the <a href="#jis0212-index">jis0212 index</a> for
   <a href="#euc-jp-second">euc-jp second</a> and <var title="">offset</var> be the
   <a href="#euc-jp-offset">euc-jp offset</a> for <var title="">octet</var>.

   <li><p>If either <var title="">lead</var> or <var title="">octet</var> is null,
   and the <a href="#fatal-flag">fatal flag</a> is set, return failure.

   <li><p>If either <var title="">lead</var> or <var title="">offset</var> is
   null, emit the <a href="#fallback-code-point">fallback code point</a>.

   <li><p>Let <var title="">code point</var> be the
   <a href="#jis-code-point">jis code point</a> for <var title="">lead</var> plus
   <var title="">offset</var>.

   <li><p>If <var title="">code point</var> is null and the
   <a href="#fatal-flag">fatal flag</a> is set, return failure.

   <li><p>If <var title="">code point</var> is null, emit the
   <a href="#fallback-code-point">fallback code point</a>.

   <li><p>Emit <var title="">code point</var>.
  </ol>

 <li><p>If <a href="#euc-jp-first">euc-jp first</a> is 0x8E and <var title="">octet</var> is
 in the range 0xA1 to 0xDF, emit a code point whose value is 0xFEC0 +
 <var title="">octet</var>.

 <li><p>If <a href="#euc-jp-first">euc-jp first</a> is 0x8F and <var title="">octet</var> is
 in the range 0xA1 to 0xFE, set <a href="#euc-jp-second">euc-jp second</a> to
 <var title="">octet</var> and continue.

 <li>
  <p>If <a href="#euc-jp-first">euc-jp first</a> is in the range 0xA1 to 0xFE, run these
  substeps:

  <ol>
   <li><p>Let <var title="">lead</var> be the <a href="#jis0208-index">jis0208 index</a> for
   <a href="#euc-jp-first">euc-jp first</a> and <var title="">offset</var> the
   <a href="#euc-jp-offset">euc-jp offset</a> for <var title="">octet</var>.

   <li><p>If the <a href="#fatal-flag">fatal flag</a> is set and either
   <var title="">lead</var> or <var title="">offset</var> is null, return failure.

   <li><p>If either <var title="">lead</var> or <var title="">offset</var> is
   null, emit the <a href="#fallback-code-point">fallback code point</a>.

   <li><p>Let <var title="">code point</var> be the
   <a href="#jis-code-point">jis code point</a> for <var title="">lead</var> plus
   <var title="">offset</var>.

   <li><p>If <var title="">code point</var> is null and the
   <a href="#fatal-flag">fatal flag</a> is set, return failure.

   <li><p>If <var title="">code point</var> is null, emit the
   <a href="#fallback-code-point">fallback code point</a>.

   <li><p>Emit <var title="">code point</var>.
  </ol>

 <li><p>If <var title="">octet</var> is in the range 0x00 to 0x7E, emit a
 code point whose value is <var title="">octet</var>.

 <li><p>If <var title="">octet</var> is 0x8E, 0x8F, or in the range 0xA1 to
 0xFE, set <a href="#euc-jp-first">euc-jp first</a> to <var title="">octet</var> and continue.

 <li><p>If the <a href="#fatal-flag">fatal flag</a> is set, return failure.

 <li><p>Set <a href="#euc-jp-first">euc-jp first</a> to 0x00 and emit the
 <a href="#fallback-code-point">fallback code point</a>.
</ol>

<p>The <dfn id="euc-jp-encoder">euc-jp encoder</dfn> (<a href="#encoder">encoder</a> for <a href="#euc-jp">euc-jp</a>) is:

<ol class="XXX">
</ol>

<p class="XXX">https://bugzilla.mozilla.org/show_bug.cgi?id=600715 encoder is more restrictive.


<h3 id="iso-2022-jp"><span class="secno">9.2 </span><dfn>iso-2022-jp</dfn></h3>
<!--
 http://tools.ietf.org/html/rfc1468
 http://tools.ietf.org/html/rfc2237 (iso-2022-jp-1)
-->

<p>The <dfn id="iso-2022-jp-offset">iso-2022-jp offset</dfn> for a given <var title="">octet</var> is
null if <var title="">octet</var> − 0x21 is greater than 93 or less than
0, or otherwise the result of that equation.

<p>The <dfn id="iso-2022-jp-state">iso-2022-jp state</dfn> is initially <b title="">ASCII state</b>.

<p>The <dfn id="iso-2022-jp-jis0212-flag">iso-2022-jp jis0212 flag</dfn> is initially unset.

<p>The <dfn id="iso-2022-jp-lead">iso-2022-jp lead</dfn> is initially 0x00.

<p>The <dfn id="iso-2022-jp-decoder">iso-2022-jp decoder</dfn> (<a href="#decoder">decoder</a> for <a href="#iso-2022-jp">iso-2022-jp</a>) is:

<ol>
 <li><p>Let <var title="">octet</var> be <a href="#octet-pointer">octet pointer</a>.

 <li><p>If <var title="">octet</var> is not the <a href="#eof-octet">EOF octet</a>,
 increase the <a href="#octet-pointer">octet pointer</a> by one.

 <li>
  <p>Based on <a href="#iso-2022-jp-state">iso-2022-jp state</a>:

  <dl class="switch">
   <dt>ASCII state

   <dd>
    <p>Based on <var title="">octet</var>:

    <dl class="switch">
     <dt>0x1B
     <dd><p>Set <a href="#iso-2022-jp-state">iso-2022-jp state</a> to
     <b title="">escape start state</b> and continue.

     <dt>0x00 to 0x7E
     <dd><p>Emit a code point whose value is <var title="">octet</var>.

     <dt><a href="#eof-octet">EOF octet</a>
     <dd><p>Emit the <a href="#eof-code-point">EOF code point</a>.

     <dt>Otherwise
     <dd>
      <p>If the <a href="#fatal-flag">fatal flag</a> is set, return failure.

      <p>Otherwise, emit the <a href="#fallback-code-point">fallback code point</a>.
    </dl>

   <dt>Escape start state
   <dd>
    <ol>
     <li><p>If <var title="">octet</var> is either <!--$-->0x24 or
     <!--(-->0x28, set <a href="#iso-2022-jp-lead">iso-2022-jp lead</a> to
     <var title="">octet</var>, <a href="#iso-2022-jp-state">iso-2022-jp state</a> to
     <b title="">escape middle state</b>, and continue.

     <li><p>If the <a href="#fatal-flag">fatal flag</a> is set, return failure.

     <li><p>If <var title="">octet</var> is not the <a href="#eof-octet">EOF octet</a>,
     decrease the <a href="#octet-pointer">octet pointer</a> by one.

     <li><p>Set <a href="#iso-2022-jp-state">iso-2022-jp state</a> to <b title="">ASCII state</b>
     and emit the <a href="#fallback-code-point">fallback code point</a>.
    </ol>

   <dt>Escape middle state
   <dd>
    <ol>
     <li><p>Let <var title="">lead</var> be <a href="#iso-2022-jp-lead">iso-2022-jp lead</a> and
     set <a href="#iso-2022-jp-lead">iso-2022-jp lead</a> to 0x00.

     <li><p>If <var title="">lead</var> is 0x24 and <var title="">octet</var> is
     either 0x40<!--@--> or 0x42<!--B-->, unset the
     <a href="#iso-2022-jp-jis0212-flag">iso-2022-jp jis0212 flag</a>, set
     <a href="#iso-2022-jp-state">iso-2022-jp state</a> to <b title="">lead state</b>, and
     continue.

     <li><p>If <var title="">lead</var> is 0x24 and <var title="">octet</var> is
     0x28, set <a href="#iso-2022-jp-state">iso-2022-jp state</a> to
     <b title="">escape final state</b> and continue.

     <li><p>If <var title="">lead</var> is 0x28 and <var title="">octet</var> is
     either 0x42<!--B--> or 0x4A<!--J-->, set <a href="#iso-2022-jp-state">iso-2022-jp state</a>
     to <b title="">ASCII state</b> and continue.

     <li><p>If <var title="">lead</var> is 0x28 and <var title="">octet</var> is
     0x49<!--I-->, set <a href="#iso-2022-jp-state">iso-2022-jp state</a> to
     <b title="">Katakana state</b> and continue.

     <li><p>If the <a href="#fatal-flag">fatal flag</a> is set, return failure.

     <li><p>If <var title="">octet</var> is the <a href="#eof-octet">EOF octet</a>,
     decrease <a href="#octet-pointer">octet pointer</a> by one, or otherwise decrease it by
     two.

     <li><p>Set <a href="#iso-2022-jp-state">iso-2022-jp state</a> to <b title="">ASCII state</b>
     and emit the <a href="#fallback-code-point">fallback code point</a>.
    </ol>

   <dt>Escape final state
   <dd>
    <ol>
     <li><p>If <var title="">octet</var> is 0x44<!--D-->, set the
     <a href="#iso-2022-jp-jis0212-flag">iso-2022-jp jis0212 flag</a>, set
     <a href="#iso-2022-jp-state">iso-2022-jp state</a> to <b title="">lead state</b>, and
     continue.

     <li><p>If the <a href="#fatal-flag">fatal flag</a> is set, return failure.

     <li><p>If <var title="">octet</var> is the <a href="#eof-octet">EOF octet</a>,
     decrease <a href="#octet-pointer">octet pointer</a> by two, or otherwise decrease it by
     three.

     <li><p>Set <a href="#iso-2022-jp-state">iso-2022-jp state</a> to <b title="">ASCII state</b>
     and emit the <a href="#fallback-code-point">fallback code point</a>.
    </ol>

   <dt>Lead state
   <dd>
    <p>Based on <var title="">octet</var>:
    <dl class="switch">
     <dt>0x0A
     <dd>
      <p>If the <a href="#fatal-flag">fatal flag</a> is set, return failure.

      <p>Otherwise, set <a href="#iso-2022-jp-state">iso-2022-jp state</a> to
      <b title="">ASCII state</b> and emit a code point whose value is U+000A.

     <dt>0x1B
     <dd><p>Set <a href="#iso-2022-jp-state">iso-2022-jp state</a> to <b title="">escape state</b>
     and continue.

     <dt><a href="#eof-octet">EOF octet</a>
     <dd><p>Emit the <a href="#eof-code-point">EOF code point</a>.

     <dt>Otherwise
     <dd>
      <p>If the <a href="#iso-2022-jp-jis0212-flag">iso-2022-jp jis0212 flag</a> is set, set
      <a href="#iso-2022-jp-lead">iso-2022-jp lead</a> to the <a href="#jis0212-index">jis0212 index</a> for
      <var title="">octet</var>, or otherwise set <a href="#iso-2022-jp-lead">iso-2022-jp lead</a>
      to the <a href="#jis0208-index">jis0208 index</a> for <var title="">octet</var>.

      <p>Then set <a href="#iso-2022-jp-state">iso-2022-jp state</a> to
      <b title="">trail state</b>, and continue.
    </dl>

   <dt>Trail state
   <dd>
    <ol>
     <li><p>Set the <a href="#iso-2022-jp-state">iso-2022-jp state</a> to
     <b title="">lead state</b>.

     <li><p>If <var title="">octet</var> is the <a href="#eof-octet">EOF octet</a> and the
     <a href="#fatal-flag">fatal flag</a> is set, return failure.

     <li><p>If <var title="">octet</var> is the <a href="#eof-octet">EOF octet</a>, emit
     the <a href="#fallback-code-point">fallback code point</a>.

     <li><p>Let <var title="">lead</var> be the <a href="#iso-2022-jp-lead">iso-2022-jp lead</a>
     and <var title="">offset</var> the <a href="#iso-2022-jp-offset">iso-2022-jp offset</a> for
     <var title="">octet</var>.

     <li><p>If the <a href="#fatal-flag">fatal flag</a> is set and either
     <var title="">lead</var> or <var title="">offset</var> is null,
     return failure.

     <li><p>If either <var title="">lead</var> or <var title="">offset</var> is
     null, emit the <a href="#fallback-code-point">fallback code point</a>.

     <li><p>Let <var title="">code point</var> be the
     <a href="#jis-code-point">jis code point</a> for <var title="">lead</var> plus
     <var title="">offset</var>.

     <li><p>If <var title="">code point</var> is null and the
     <a href="#fatal-flag">fatal flag</a> is set, return failure.

     <li><p>If <var title="">code point</var> is null, emit the
     <a href="#fallback-code-point">fallback code point</a>.

     <li><p>Emit <var title="">code point</var>.
    </ol>

   <dt>Katakana state
   <dd>
    <p>Based on <var title="">octet</var>:
    <dl class="switch">
     <dt>0x1B
     <dd><p>Set <a href="#iso-2022-jp-state">iso-2022-jp state</a> to <b title="">escape state</b>
     and continue.

     <dt>0x21 to 0x5F
     <dd><p>Emit a code point whose value is 0xFF40 +
     <var title="">octet</var>.

     <dt><a href="#eof-octet">EOF octet</a>
     <dd><p>Emit the <a href="#eof-code-point">EOF code point</a>.

     <dt>Otherwise
     <dd>
      <p>If the <a href="#fatal-flag">fatal flag</a> is set, return failure.

      <p>Otherwise, emit the <a href="#fallback-code-point">fallback code point</a>.
    </dl>
  </dl>
</ol>

<p>The <dfn id="iso-2022-jp-encoder">iso-2022-jp encoder</dfn> (<a href="#encoder">encoder</a> for <a href="#iso-2022-jp">iso-2022-jp</a>) is:

<ol class="XXX"></ol>


<h3 id="shift_jis"><span class="secno">9.3 </span><dfn>shift_jis</dfn></h3>

<p>The <dfn id="shift_jis-fallback-code-point">shift_jis fallback code point</dfn> is U+30FB.</p>

<p>The <dfn id="shift_jis-lead-octet-index-or-code-point">shift_jis lead octet index or code point</dfn> for a given
<var title="">octet</var> is:</p>

<dl class="switch">
 <dt>0x81
 <dd>8648

 <dt>0x82 to 0x84
 <dd>(<var title="">octet</var> − 0x80) × 188

 <dt>0x87 to 0x9F
 <dd>(<var title="">octet</var> − 0x82) × 188

 <dt>0xA0
 <dd>0xF8F0

 <dt>0xA1 to 0xDF
 <dd>0xFEC0 + <var title="">octet</var>

 <dt>0xE1 to 0xEA
 <dd>(<var title="">octet</var> − 0xC2) × 188

 <dt>0xED to 0xEE
 <dd>(<var title="">octet</var> − 0xC4) × 188

 <dt>0xF0 to 0xF9
 <dd>0xE000 + (<var title="">octet</var> − 0xF0) × 188

 <dt>0xFA to 0xFC
 <dd>(<var title="">octet</var> − 0xCF) × 188

  <dt>0xFD to 0xFF
  <dd>0xF7F4 + <var title="">octet</var>

  <dt>Otherwise
  <dd>null
</dl>

<p>The <dfn id="shift_jis-offset">shift_jis offset</dfn> for a given <var title="">octet</var> is:

<dl class="switch">
 <dt>0x40 to 0x7E</dt>
 <dd><var title="">octet</var> − 0x40

 <dt>0x80 to 0x7C</dt>
 <dd><var title="">octet</var> − 0x41

 <dt>Otherwise</dt>
 <dd>null
</dl>

<p>The <dfn id="shift_jis-lead">shift_jis lead</dfn> is initially 0x00.

<p>The <dfn id="shift_jis-decoder">shift_jis decoder</dfn> (<a href="#decoder">decoder</a> for <a href="#shift_jis">shift_jis</a>) is:

<ol>
 <li><p>Let <var title="">octet</var> be <a href="#octet-pointer">octet pointer</a>.

 <li><p>If <var title="">octet</var> is the <a href="#eof-octet">EOF octet</a> and
 <a href="#shift_jis-lead">shift_jis lead</a> is 0x00, emit the
 <a href="#eof-code-point">EOF code point</a>.

 <li><p>If <var title="">octet</var> is the <a href="#eof-octet">EOF octet</a>,
 <a href="#shift_jis-lead">shift_jis lead</a> is not 0x00, and the <a href="#fatal-flag">fatal flag</a> is
 set, return failure.

 <li><p>If <var title="">octet</var> is the <a href="#eof-octet">EOF octet</a>,
 <a href="#shift_jis-lead">shift_jis lead</a> is not 0x00, emit the
 <a href="#fallback-code-point">fallback code point</a>.

 <li><p>Increase the <a href="#octet-pointer">octet pointer</a> by one.

 <li><p>If <a href="#shift_jis-lead">shift_jis lead</a> is 0x00 and <var title="">octet</var> is
 in the range 0x00 to 0x80, emit a code point whose value is
 <var title="">octet</var>.

 <li><p>If <a href="#shift_jis-lead">shift_jis lead</a> is 0x00, set
 <a href="#shift_jis-lead">shift_jis lead</a> to the
 <a href="#shift_jis-lead-octet-index-or-code-point">shift_jis lead octet index or code point</a> for
 <var title="">octet</var> and continue.

 <li>
  <p>If <a href="#shift_jis-lead">shift_jis lead</a> is either less than 0xF8F0 or null, run
  these substeps:

  <ol>
   <li><p>Let <var title="">offset</var> be the
   <a href="#shift_jis-offset">shift_jis offset</a> for <var title="">octet</var>.

   <li><p>If either <var title="">offset</var> or <a href="#shift_jis-lead">shift_jis lead</a>
   is null and the <a href="#fatal-flag">fatal flag</a> is set, return failure.

   <li><p>If <var title="">offset</var> is null, set
   <a href="#shift_jis-lead">shift_jis lead</a> to 0x00, decrease the
   <a href="#octet-pointer">octet pointer</a> by one and emit the
   <a href="#fallback-code-point">fallback code point</a>.

   <li><p>If <a href="#shift_jis-lead">shift_jis lead</a> is equal or more than 0xE000, emit
   a code point whose value is <var title="">lead</var> plus
   <var title="">offset</var>.

   <li><p>Otherwise, if <a href="#shift_jis-lead">shift_jis lead</a> is null, emit a
   <a href="#shift_jis-fallback-code-point">shift_jis fallback code point</a>.

   <li><p>Otherwise, let <var title="">code point</var> be the
   <a href="#jis-code-point">jis code point</a> for <a href="#shift_jis-lead">shift_jis lead</a> plus
   <var title="">offset</var>.

   <li><p>If <var title="">code point</var> is null and the
   <a href="#fatal-flag">fatal flag</a> is set, return failure.

   <li><p>If <var title="">code point</var> is null, emit a
   <a href="#shift_jis-fallback-code-point">shift_jis fallback code point</a>.

   <li><p>Emit <var title="">code point</var>.
  </ol>

 <li><p>Otherwise, emit a code point whose value is
 <a href="#shift_jis-lead">shift_jis lead</a>.
</ol>

<p>The <dfn id="shift_jis-encoder">shift_jis encoder</dfn> (<a href="#encoder">encoder</a> for <a href="#shift_jis">shift_jis</a>) is:

<ol class="XXX"></ol>


<h2 id="legacy-multi-octet-korean-encodings"><span class="secno">10 </span>Legacy multi-octet Korean encodings</h2>

<p class="XXX">The <dfn id="euc-kr-code-point">euc-kr code point</dfn> for two octets
(<var title="">octet<sub>1</sub></var>, <var title="">octet<sub>2</sub></var>) is
...

<h3 id="euc-kr"><span class="secno">10.1 </span><dfn>euc-kr</dfn></h3><!-- cp949 -->

<p>The <dfn id="euc-kr-lead">euc-kr lead</dfn> is initially 0x00.

<p>The <dfn id="euc-kr-decoder">euc-kr decoder</dfn> (<a href="#decoder">decoder</a> for <a href="#euc-kr">euc-kr</a>) is:
<!-- identical to big5 -->

<ol>
 <li><p>Let <var title="">octet</var> be <a href="#octet-pointer">octet pointer</a>.

 <li><p>If <var title="">octet</var> is the <a href="#eof-octet">EOF octet</a> and
 <a href="#euc-kr-lead">euc-kr lead</a> is 0x00, emit the
 <a href="#eof-code-point">EOF code point</a>.

 <li><p>If <var title="">octet</var> is the <a href="#eof-octet">EOF octet</a>,
 <a href="#euc-kr-lead">euc-kr lead</a> is not 0x00, and the <a href="#fatal-flag">fatal flag</a> is
 set, return failure.

 <li><p>If <var title="">octet</var> is the <a href="#eof-octet">EOF octet</a>,
 <a href="#euc-kr-lead">euc-kr lead</a> is not 0x00, emit the
 <a href="#fallback-code-point">fallback code point</a>.

 <li><p>Increase the <a href="#octet-pointer">octet pointer</a> by one.

 <li><p>If <a href="#euc-kr-lead">euc-kr lead</a> is 0x00 and <var title="">octet</var> is
 in the range 0x00 to 0x7F, emit a code point whose value is
 <var title="">octet</var>.

 <li><p>If <a href="#euc-kr-lead">euc-kr lead</a> is 0x00, set <a href="#euc-kr-lead">euc-kr lead</a>
 to <var title="">octet</var> and continue.

 <li><p>Let <var title="">code point</var> be the
 <a href="#euc-kr-code-point">euc-kr code point</a> for
 (<a href="#euc-kr-lead">euc-kr lead</a>, <var title="">octet</var>).

 <li><p>Set <a href="#euc-kr-lead">euc-kr lead</a> to 0x00.

 <li><p>If <var title="">code point</var> is not null, emit
 <var title="">code point</var>.

 <li><p>If the <a href="#fatal-flag">fatal flag</a> is set, return failure.

 <li><p>If <var title="">octet</var> is in the range 0x00 0x7F, decrease the
 <a href="#octet-pointer">octet pointer</a> by one.

 <li><p>Emit the <a href="#fallback-code-point">fallback code point</a>.
</ol>

<p>The <dfn id="euc-kr-encoder">euc-kr encoder</dfn> (<a href="#encoder">encoder</a> for <a href="#euc-kr">euc-kr</a>) is:

<ol class="XXX"></ol>


<h3 id="iso-2022-kr"><span class="secno">10.2 </span><dfn>iso-2022-kr</dfn></h3>

<!--XXX the "ESC $ ) C" sequence is only supported by Gecko at the start of
a stream. It does exactly nothing. Trying to get away with not supporting it
at all.-->

<p>The <dfn id="iso-2022-kr-state">iso-2022-kr state</dfn> is initially <b title="">ASCII state</b>.

<p>The <dfn id="iso-2022-kr-lead">iso-2022-kr lead</dfn> is initially 0x00.

<p>The <dfn id="iso-2022-kr-decoder">iso-2022-kr decoder</dfn> (<a href="#decoder">decoder</a> for <a href="#iso-2022-kr">iso-2022-kr</a>) is:

<ol>
 <li><p>Let <var title="">octet</var> be <a href="#octet-pointer">octet pointer</a>.

 <li><p>If <var title="">octet</var> is not the <a href="#eof-octet">EOF octet</a>,
 increase the <a href="#octet-pointer">octet pointer</a> by one.

 <li>
  <p>Based on <a href="#iso-2022-kr-state">iso-2022-kr state</a>:

  <dl class="switch">
   <dt>ASCII state

   <dd>
    <p>Based on <var title="">octet</var>:

    <dl class="switch">
     <dt>0x0E
     <dd><p>Set <a href="#iso-2022-kr-state">iso-2022-kr state</a> to <b title="">lead state</b>
     and continue.

     <dt>0x0F
     <dd><p>Continue.

     <dt>0x00 to 0x7E
     <dd><p>Emit a code point whose value is <var title="">octet</var>.

     <dt><a href="#eof-octet">EOF octet</a>
     <dd><p>Emit the <a href="#eof-code-point">EOF code point</a>.

     <dt>Otherwise
     <dd>
      <p>If the <a href="#fatal-flag">fatal flag</a> is set, return failure.

      <p>Otherwise, emit the <a href="#fallback-code-point">fallback code point</a>.
    </dl>

   <dt>Lead state
   <dd>
    <p>Based on <var title="">octet</var>:
    <dl class="switch">
     <dt>0x0A
     <dd>
      <p>If the <a href="#fatal-flag">fatal flag</a> is set, return failure.

      <p>Otherwise, set <a href="#iso-2022-kr-state">iso-2022-kr state</a> to
      <b title="">ASCII state</b> and emit a code point whose value is U+000A.

     <dt>0x0E
     <dd><p>Continue.

     <dt>0x0F
     <dd><p>Set <a href="#iso-2022-kr-state">iso-2022-kr state</a> to <b title="">ASCII state</b>
     and continue.

     <dt><a href="#eof-octet">EOF octet</a>
     <dd><p>Emit the <a href="#eof-code-point">EOF code point</a>.

     <dt>Otherwise
     <dd>
      <p>Set <a href="#iso-2022-kr-lead">iso-2022-kr lead</a> to <var title="">octet</var>, set
      <a href="#iso-2022-kr-state">iso-2022-kr state</a> to <b title="">trail state</b>, and
      continue.
    </dl>

   <dt>Trail state
   <dd>
    <ol>
     <li><p>Set the <a href="#iso-2022-kr-state">iso-2022-kr state</a> to
     <b title="">lead state</b>.

     <li><p>If <var title="">octet</var> is the <a href="#eof-octet">EOF octet</a> and the
     <a href="#fatal-flag">fatal flag</a> is set, return failure.

     <li><p>If <var title="">octet</var> is the <a href="#eof-octet">EOF octet</a>, emit
     the <a href="#fallback-code-point">fallback code point</a>.

     <li><p>If either <a href="#iso-2022-kr-lead">iso-2022-kr lead</a> or
     <var title="">octet</var> is not in the range 0x21 to 0x7E, let
     <var title="">code point</var> be null, or otherwise let
     <var title="">code point</var> be the <a href="#euc-kr-code-point">euc-kr code point</a> for
     (<a href="#iso-2022-kr-lead">iso-2022-kr lead</a> + 0x80, <var title="">octet</var> + 0x80).

     <li><p>If <var title="">code point</var> is not null, emit
     <var title="">code point</var>.

     <li><p>If the <a href="#fatal-flag">fatal flag</a> is set, return failure.

     <li><p>Emit the <a href="#fallback-code-point">fallback code point</a>.
    </ol>
  </dl>
</ol>

<p>The <dfn id="iso-2022-kr-encoder">iso-2022-kr encoder</dfn> (<a href="#encoder">encoder</a> for <a href="#iso-2022-kr">iso-2022-kr</a>) is:

<ol class="XXX"></ol>


<h2 id="legacy-utf-16-encodings"><span class="secno">11 </span>Legacy utf-16 encodings</h2>

<p class="note">Contrary to the Unicode standard, checking for a BOM happens
before an encoding to decode an octet stream is chosen.


<h3 id="utf-16"><span class="secno">11.1 </span><dfn>utf-16</dfn></h3>

<p class="XXX">AKA utf-16le


<h3 id="utf-16be"><span class="secno">11.2 </span><dfn>utf-16be</dfn></h3>

<p class="XXX">...


<h2 class="no-num" id="references">References</h2>

<div id="anolis-references"><dl><dt id="refsRFC2119">[RFC2119]
<dd><cite><a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a></cite>, Scott Bradner. IETF.

</dl></div>


<h2 class="no-num" id="acknowledgments">Acknowledgments</h2>

<p>There have been a lot of people that have helped make encodings more
interoperable over the years and thereby furthered the goals of this
standard. Likewise people have helped making this standard what it is today.

<p>Ideally they are all listed here so please contact the editor with any
omissions.

<p>With that, many thanks to

Erik van der Poel,
譚永鋒 (Frank Yung-Fong Tang),
Ian Hickson,
신정식 (Jungshik Shin),
Mark Callow,
Mark Davis,
Martin Dürst,
Masatoshi Kimura,
Ms2ger,
Øistein E. Andersen,
Peter Krefting,
Philip Taylor,
Shawn Steele,
Simon Montagu,
Simon Pieters, and
成瀬ゆい (Yui Naruse)

for being awesome.

<p class="XXX">Clearly not complete at this point, but better than nothing.


<script class="dontpublish" id="head" src="http://www.whatwg.org/specs/web-apps/current-work/dfn.js"></script>
